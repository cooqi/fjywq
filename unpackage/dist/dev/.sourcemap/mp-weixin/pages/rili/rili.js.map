{"version":3,"file":"rili.js","sources":["pages/rili/rili.vue","D:/ruanjian/HBuilderX.3.6.18.20230117/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvcmlsaS9yaWxpLnZ1ZQ"],"sourcesContent":["<template>\r\n\t<view class=\"calendar\">\r\n\t\t  <EmbedCalendar\r\n\t\t    :show-top-section=\"true\"\r\n\t\t    :greeting-text=\"customGreeting\"\r\n\t\t    :signed-dates=\"signedDates\"\r\n\t\t    :weekstart=\"1\"\r\n\t\t    :open=\"true\"\r\n\t\t\t:bgcolorGreeting=\"bgcolorGreeting\"\r\n\t\t\t@on-click=\"handleDateClick\"\r\n\t\t\t@today-plan-click=\"handleTodayPlanClick\"\r\n\t\t\t@year-month-change=\"yearMonthChange\"\r\n\t\t\t@month-change=\"yearMonthChange\"\r\n\t\t  />\r\n\t  </view>\r\n\t<view class=\"content\">\r\n\t\t<view class=\"uni-padding-wrap uni-common-mt segmented\">\r\n\t\t\t<uni-segmented-control :current=\"current\" :values=\"items\" style-type=\"text\"\r\n\t\t\t\t @clickItem=\"onClickItem\" />\r\n\t\t</view>\r\n\t\t\r\n\t\t<view v-if=\"current === 0\">\r\n\t\t\t<view v-for=\"item in dayInfo\" :key=\"item._id\" class=\"info\">\r\n\t\t\t\t<view class=\"date\">{{item.date}}</view>\r\n\t\t\t\t<view class=\"title\">{{item.title}}</view>\r\n\t\t\t\t<view class=\"bz\" v-html=\"item.bz\"></view>\r\n\t\t\t</view>\r\n\t\t\t<view v-if=\"!dayInfo.length\">当前日期暂无青宇当天事件，如需补充，请联系管理员，如不认识管理员请小红书发帖带上tag#宇青青宇备忘录#，管理员看到后会核实添加</view>\r\n\t\t</view>\r\n\t\t<view v-if=\"current === 1\">\r\n\t\t\t<view v-for=\"item in dayAboutInfo\" :key=\"item._id\" class=\"info\">\r\n\t\t\t\t<view class=\"date\">{{item.date}}</view>\r\n\t\t\t\t<view class=\"title\">{{item.title}}</view>\r\n\t\t\t\t<view class=\"bz\" v-html=\"item.bz\"></view>\r\n\t\t\t</view>\r\n\t\t\t<view v-if=\"!dayAboutInfo.length\">当前日期暂无青宇相关事件，如需补充，请联系管理员，如不认识管理员请小红书发帖带上tag#宇青青宇备忘录#，管理员看到后会核实添加</view>\r\n\t\t</view>\r\n\t\t\r\n\t\t\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport EmbedCalendar from '../../components/fd-EmbedCalendar/fd-EmbedCalendar.vue'\r\n\texport default {\r\n\t\tcomponents: {\r\n\t\t  EmbedCalendar\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\t userAvatar: '/static/user-avatar.png',\r\n\t\t\t\t  customGreeting: '豹豹杯杯儿，今天也要加油哦！',\r\n\t\t\t\t  //1 onlyFJY 2onlyWQ 3all\r\n\t\t\t\t  signedDates: [], // 已签到日期\r\n\t\t\t\t  allRili:[],\r\n\t\t\t\t  dayInfo:[],\r\n\t\t\t\t  dayAboutInfo:[],\r\n\t\t\t\t  bgcolorGreeting:'',\r\n\t\t\t\t  items: ['当天事件', '相关事件'],\r\n\t\t\t\t  current: 0,\r\n\t\t\t\t  \t\t\t\t\r\n\t\t\t}\r\n\t\t},\r\n\t\tonLoad() {\r\n\t\t\tthis.getList()\r\n\t\t\tthis.useCommon()\r\n\t\t\t\r\n\t\t},\r\n\t\twatch:{\r\n\t\t\tdayAboutInfo:{\r\n\t\t\t\thandler(val){\r\n\t\t\t\t\tlet len= val.length\r\n\t\t\t\t\tif(len){\r\n\t\t\t\t\t\tthis.items[1]=`相关事件(${len}条)`\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tthis.items[1]='相关事件'\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\timmediate:true,\r\n\t\t\t\tdeep:true\r\n\t\t\t}\r\n\t\t},\r\n\t\tonShareAppMessage: function () {\r\n\t\t   return {\r\n\t\t     title: '宇青青宇全肯定',\r\n\t\t     path: '/pages/rili/rili'\r\n\t\t   }\r\n\t\t },\r\n\t\t onShareTimeline: function () {\r\n\t\t    return {\r\n\t\t      title: '宇青青宇全肯定'\r\n\t\t    }\r\n\t\t  },\r\n\t\tmethods: {\r\n\t\t\t\r\n\t\t\t// 日期点击事件\r\n\t\t\t    handleDateClick(dateInfo) {\r\n\t\t\t     // console.log('选中日期:', dateInfo);\r\n\t\t\t      // dateInfo 包含：date, year, month, day, isToday\r\n\t\t\t\t  let {month, day,date}=dateInfo\r\n\t\t\t\t  this.getDetail(date)\r\n\t\t\t    },\r\n\t\t\t\r\n\t\t\t    // 月份变化事件\r\n\t\t\t    handleMonthChange(monthInfo) {\r\n\t\t\t     // console.log('月份变化:', monthInfo);\r\n\t\t\t      // monthInfo 包含：year, month\r\n\t\t\t    },\r\n\t\t\t\r\n\t\t\t    // 今日计划点击事件\r\n\t\t\t    handleTodayPlanClick() {\r\n\t\t\t      this.getDetail()\r\n\t\t\t    },\r\n\t\t\t\t//年月切换\r\n\t\t\t\tyearMonthChange(){\r\n\t\t\t\t\tthis.dayInfo=[]\r\n\t\t\t\t\tthis.current=0\r\n\t\t\t\t},\r\n\t\t\tadd() {\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\ttitle: '处理中...'\r\n\t\t\t\t})\r\n\t\t\t\tuniCloud.callFunction({\r\n\t\t\t\t\tname: 'rili-add',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tproduct: 'uniCloud',\r\n\t\t\t\t\t\tcreate_time: Date.now()\r\n\t\t\t\t\t}\r\n\t\t\t\t}).then((res) => {\r\n\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\tcontent: `成功添加一条数据，文档id为：${res.result.id}`,\r\n\t\t\t\t\t\tshowCancel: false\r\n\t\t\t\t\t})\r\n\t\t\t\t}).catch((err) => {\r\n\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\tcontent: `添加数据失败，错误信息为：${err.message}`,\r\n\t\t\t\t\t\tshowCancel: false\r\n\t\t\t\t\t})\r\n\t\t\t\t\tconsole.error(err)\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tremove() {\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\ttitle: '处理中...'\r\n\t\t\t\t})\r\n\t\t\t\tuniCloud.callFunction({\r\n\t\t\t\t\tname: 'remove'\r\n\t\t\t\t}).then((res) => {\r\n\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\tcontent: res.result.msg,\r\n\t\t\t\t\t\tshowCancel: false\r\n\t\t\t\t\t})\r\n\t\t\t\t\t//console.log(res)\r\n\t\t\t\t}).catch((err) => {\r\n\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\tcontent: `删除失败，错误信息为：${err.message}`,\r\n\t\t\t\t\t\tshowCancel: false\r\n\t\t\t\t\t})\r\n\t\t\t\t\tconsole.error(err)\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tupdate() {\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\ttitle: '处理中...'\r\n\t\t\t\t})\r\n\t\t\t\tuniCloud.callFunction({\r\n\t\t\t\t\tname: 'update',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tproduct: 'uni-app',\r\n\t\t\t\t\t\tcreate_time: Date.now()\r\n\t\t\t\t\t}\r\n\t\t\t\t}).then((res) => {\r\n\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\tcontent: res.result.msg,\r\n\t\t\t\t\t\tshowCancel: false\r\n\t\t\t\t\t})\r\n\t\t\t\t\t//console.log(res)\r\n\t\t\t\t}).catch((err) => {\r\n\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\tcontent: `更新操作执行失败，错误信息为：${err.message}`,\r\n\t\t\t\t\t\tshowCancel: false\r\n\t\t\t\t\t})\r\n\t\t\t\t\tconsole.error(err)\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tgetList() {\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\ttitle: '处理中...'\r\n\t\t\t\t})\r\n\t\t\t\tuniCloud.callFunction({\r\n\t\t\t\t\tname: 'rili-get'\r\n\t\t\t\t}).then((res) => {\r\n\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\tthis.allRili=JSON.parse(JSON.stringify(res.result.data))\r\n\t\t\t\t\tthis.getDetail()\r\n\t\t\t\t\tconst arr=res.result.data.map(item=>{\r\n\t\t\t\t\t\tlet d=item.date.split('-')\r\n\t\t\t\t\t\td.shift()\r\n\t\t\t\t\t\treturn d.join('-')\r\n\t\t\t\t\t})\r\n\t\t\t\t\tconsole.log('arr',arr)\r\n\t\t\t\t\tthis.signedDates= [...new Set(arr)];\r\n\t\t\t\t}).catch((err) => {\r\n\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\tcontent: `查询失败，错误信息为：${err.message}`,\r\n\t\t\t\t\t\tshowCancel: false\r\n\t\t\t\t\t})\r\n\t\t\t\t\tconsole.error(err)\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tonClickItem(e) {\r\n\t\t\t\tif (this.current !== e.currentIndex) {\r\n\t\t\t\t\tthis.current = e.currentIndex\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tformatDate(date) {\r\n\t\t\t  const year = date.getFullYear();\r\n\t\t\t  const month = String(date.getMonth() + 1).padStart(2, '0');\r\n\t\t\t  const day = String(date.getDate()).padStart(2, '0');\r\n\t\t\t  return `${year}-${month}-${day}`;\r\n\t\t\t},\r\n\t\t\tgetDetail(time) {\r\n\t\t\t\tthis.current=0\r\n\t\t\t\tconst now=time?new Date(time.replace(/-/g,'/')):new Date()\r\n\t\t\r\n\t\t\t\t// 获取月份 (0-11, 0表示一月)\r\n\t\t\t\tconst month = now.getMonth() + 1; // 需要 +1 得到实际月份\r\n\t\t\t\t// 获取日期 (1-31)\r\n\t\t\t\tconst day = now.getDate();\r\n\t\t\t\tthis.dayAboutInfo=this.allRili.filter(item=>{\r\n\t\t\t\t\tconst t=new Date(item.date.replace(/-/g,'/'));\r\n\t\t\t\t\tconst m=t.getMonth() + 1;\r\n\t\t\t\t\tconst d=t.getDate()\r\n\t\t\t\t\t//console.log(time,month,day,m,d,item)\r\n\t\t\t\t\tconst tt=this.formatDate(t)\r\n\t\t\t\t\tconst nn=this.formatDate(now)\r\n\t\t\t\t\treturn month===m&&day===d&&tt!=nn\r\n\t\t\t\t\t\r\n\t\t\t\t})\r\n\t\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\tthis.dayInfo=this.allRili.filter(item=>{\r\n\t\t\t\t\tconst t=new Date(item.date.replace(/-/g,'/'));\r\n\t\t\t\t\tconst m=this.formatDate(t)\r\n\t\t\t\t\tconst n=this.formatDate(now)\r\n\t\t\t\t\tconsole.log(1,m,n)\r\n\t\t\t\t\treturn m===n\r\n\t\t\t\t\t\r\n\t\t\t\t})\r\n\t\t\t\tif(!this.dayInfo.length&&this.dayAboutInfo.length){\r\n\t\t\t\t\tthis.current=1\r\n\t\t\t\t}else{\r\n\t\t\t\t\tthis.current=0\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tuseCommon() {\r\n\t\t\t\t\r\n\t\t\t\tuniCloud.callFunction({\r\n\t\t\t\t\tname: 'welcome'\r\n\t\t\t\t}).then((res) => {\r\n\t\t\t\t\tlet data=res.result.data[0]\r\n\t\t\t\t\tthis.customGreeting=data.title || '豹豹杯杯儿，你们最棒'\r\n\t\t\t\t\tthis.bgcolorGreeting=data.bgcolor\r\n\t\t\t\t}).catch((err) => {\r\n\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\tcontent: `云函数use-common执行失败，错误信息为：${err.message}`,\r\n\t\t\t\t\t\tshowCancel: false\r\n\t\t\t\t\t})\r\n\t\t\t\t\tconsole.error(err)\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\ttoRedisPage(){\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl:'/pages/cloudFunction/redis/redis'\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n\t.content {\r\n\t\tpadding: 20px;\r\n\t\tbackground: #aaa1ce;\r\n\t\tcolor: #fff;\r\n\t}\r\n\t.info{\r\n\t\tmargin: 10px 0;\r\n\t\tborder-bottom: 1px dashed #fff;\r\n\t\tpadding: 10px 0;\r\n\t\t&:last-child{\r\n\t\t\tborder-bottom:none;\r\n\t\t}\r\n\t}\r\n\t\r\n\t.date{\r\n\t\tfont-size: 20px;\r\n\t\tfont-weight: bold;\r\n\t}\r\n\t.segmented{\r\n\t\tmargin-bottom: 15px;;\r\n\t}\r\n\r\n\t\r\n</style>","import MiniProgramPage from 'E:/web/cooqi/fjywq/pages/rili/rili.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni"],"mappings":"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"}