{"version":3,"file":"sloarToLunar.js","sources":["components/Li-Calendar/sloarToLunar.js"],"sourcesContent":["/* 公历转农历代码思路：\r\n1、建立农历年份查询表\r\n2、计算输入公历日期与公历基准的相差天数\r\n3、从农历基准开始遍历农历查询表，计算自农历基准之后每一年的天数，并用相差天数依次相减，确定农历年份\r\n4、利用剩余相差天数以及农历每个月的天数确定农历月份\r\n5、利用剩余相差天数确定农历哪一天 */\r\nvar lunarYearTool = {\r\n\t// 农历1949-2100年查询表\r\n\tlunarYearArr: [\r\n\t\t0x0b557, //1949\r\n\t\t0x06ca0, 0x0b550, 0x15355, 0x04da0, 0x0a5b0, 0x14573, 0x052b0, 0x0a9a8, 0x0e950, 0x06aa0, //1950-1959\r\n\t\t0x0aea6, 0x0ab50, 0x04b60, 0x0aae4, 0x0a570, 0x05260, 0x0f263, 0x0d950, 0x05b57, 0x056a0, //1960-1969\r\n\t\t0x096d0, 0x04dd5, 0x04ad0, 0x0a4d0, 0x0d4d4, 0x0d250, 0x0d558, 0x0b540, 0x0b6a0, 0x195a6, //1970-1979\r\n\t\t0x095b0, 0x049b0, 0x0a974, 0x0a4b0, 0x0b27a, 0x06a50, 0x06d40, 0x0af46, 0x0ab60, 0x09570, //1980-1989\r\n\t\t0x04af5, 0x04970, 0x064b0, 0x074a3, 0x0ea50, 0x06b58, 0x055c0, 0x0ab60, 0x096d5, 0x092e0, //1990-1999\r\n\t\t0x0c960, 0x0d954, 0x0d4a0, 0x0da50, 0x07552, 0x056a0, 0x0abb7, 0x025d0, 0x092d0, 0x0cab5, //2000-2009\r\n\t\t0x0a950, 0x0b4a0, 0x0baa4, 0x0ad50, 0x055d9, 0x04ba0, 0x0a5b0, 0x15176, 0x052b0, 0x0a930, //2010-2019\r\n\t\t0x07954, 0x06aa0, 0x0ad50, 0x05b52, 0x04b60, 0x0a6e6, 0x0a4e0, 0x0d260, 0x0ea65, 0x0d530, //2020-2029\r\n\t\t0x05aa0, 0x076a3, 0x096d0, 0x04afb, 0x04ad0, 0x0a4d0, 0x1d0b6, 0x0d250, 0x0d520, 0x0dd45, //2030-2039\r\n\t\t0x0b5a0, 0x056d0, 0x055b2, 0x049b0, 0x0a577, 0x0a4b0, 0x0aa50, 0x1b255, 0x06d20, 0x0ada0, //2040-2049\r\n\t\t0x14b63, 0x09370, 0x049f8, 0x04970, 0x064b0, 0x168a6, 0x0ea50, 0x06b20, 0x1a6c4, 0x0aae0, //2050-2059\r\n\t\t0x0a2e0, 0x0d2e3, 0x0c960, 0x0d557, 0x0d4a0, 0x0da50, 0x05d55, 0x056a0, 0x0a6d0, 0x055d4, //2060-2069\r\n\t\t0x052d0, 0x0a9b8, 0x0a950, 0x0b4a0, 0x0b6a6, 0x0ad50, 0x055a0, 0x0aba4, 0x0a5b0, 0x052b0, //2070-2079\r\n\t\t0x0b273, 0x06930, 0x07337, 0x06aa0, 0x0ad50, 0x14b55, 0x04b60, 0x0a570, 0x054e4, 0x0d160, //2080-2089\r\n\t\t0x0e968, 0x0d520, 0x0daa0, 0x16aa6, 0x056d0, 0x04ae0, 0x0a9d4, 0x0a2d0, 0x0d150, 0x0f252, //2090-2099\r\n\t\t0x0d520 //2100\r\n\t],\r\n\tlunarMonth: ['正', '二', '三', '四', '五', '六', '七', '八', '九', '十', '冬', '腊'],\r\n\tlunarDay: ['一', '二', '三', '四', '五', '六', '七', '八', '九', '十', '初', '廿'],\r\n\ttianGan: ['甲', '乙', '丙', '丁', '戊', '己', '庚', '辛', '壬', '癸'],\r\n\tdiZhi: ['子', '丑', '寅', '卯', '辰', '巳', '午', '未', '申', '酉', '戌', '亥'],\r\n\t/**\r\n\t * @description \t公历转农历函数\r\n\t * @param {int} sy \t年份\r\n\t * @param {int} sm \t月份\r\n\t * @param {int} sd\t日期\r\n\t * */\r\n\tsloarToLunar: function(sy, sm, sd) { // \r\n\t\tlet that = this;\r\n\t\t// 输入的月份减1处理\r\n\t\tsm -= 1;\r\n\r\n\t\t// 计算与公历基准的相差天数\r\n\t\t// Date.UTC()返回的是距离公历1970年1月1日的毫秒数,传入的月份需要减1\r\n\t\tlet daySpan = (Date.UTC(sy, sm, sd) - Date.UTC(1949, 0, 29)) / (24 * 60 * 60 * 1000) + 1;\r\n\t\tlet ly, lm, ld;\r\n\t\t// 确定输出的农历年份\r\n\t\tfor (let j = 0; j < that.lunarYearArr.length; j++) {\r\n\t\t\tlet tempDaySpan = that.lunarYearDays(that.lunarYearArr[j]);\r\n\t\t\tdaySpan -= tempDaySpan\r\n\t\t\tif (daySpan <= 0) {\r\n\t\t\t\tly = 1949 + j;\r\n\t\t\t\t// 获取农历年份确定后的剩余天数\r\n\t\t\t\tdaySpan += tempDaySpan;\r\n\t\t\t\tbreak\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// 确定输出的农历月份\r\n\t\tlet lunarYearMonthsList = that.lunarYearMonths(that.lunarYearArr[ly - 1949])\r\n\t\tlet hasLeapMonth_Result = that.hasLeapMonth(that.lunarYearArr[ly - 1949]);\r\n\t\tfor (let k = 0; k < lunarYearMonthsList.length; k++) {\r\n\t\t\tdaySpan -= lunarYearMonthsList[k];\r\n\t\t\tif (daySpan <= 0) {\r\n\t\t\t\t// 有闰月时，月份的数组长度会变成13，因此，当闰月月份小于等于k时，lm不需要加1\r\n\t\t\t\tif (hasLeapMonth_Result && hasLeapMonth_Result <= k) {\r\n\t\t\t\t\tif (hasLeapMonth_Result < k) {\r\n\t\t\t\t\t\tlm = k;\r\n\t\t\t\t\t} else if (hasLeapMonth_Result === k) {\r\n\t\t\t\t\t\tlm = '闰' + k;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tlm = k + 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlm = k + 1;\r\n\t\t\t\t}\r\n\t\t\t\t// 获取农历月份确定后的剩余天数\r\n\t\t\t\tdaySpan += lunarYearMonthsList[k];\r\n\t\t\t\tbreak\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// 确定输出农历哪一天\r\n\t\tld = daySpan;\r\n\r\n\t\t// 将计算出来的农历月份转换成汉字月份，闰月需要在前面加上闰字\r\n\t\tif (hasLeapMonth_Result && (typeof(lm) === 'string' && lm.indexOf('闰') > -1)) {\r\n\t\t\tlm = `闰${this.lunarMonth[/\\d/.exec(lm) - 1]}`\r\n\t\t} else {\r\n\t\t\tlm = that.lunarMonth[lm - 1];\r\n\t\t}\r\n\r\n\t\t// 将计算出来的农历年份转换为天干地支年\r\n\t\tly = that.getTianGan(ly) + that.getDiZhi(ly);\r\n\r\n\t\t// 将计算出来的农历天数转换成汉字\r\n\t\tif (ld < 11) {\r\n\t\t\tld = `${this.lunarDay[10]}${this.lunarDay[ld-1]}`\r\n\t\t} else if (ld > 10 && ld < 20) {\r\n\t\t\tld = `${this.lunarDay[9]}${this.lunarDay[ld-11]}`\r\n\t\t} else if (ld === 20) {\r\n\t\t\tld = `${this.lunarDay[1]}${this.lunarDay[9]}`\r\n\t\t} else if (ld > 20 && ld < 30) {\r\n\t\t\tld = `${this.lunarDay[11]}${this.lunarDay[ld-21]}`\r\n\t\t} else if (ld === 30) {\r\n\t\t\tld = `${this.lunarDay[2]}${this.lunarDay[9]}`\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tlunarYear: ly,\r\n\t\t\tlunarMonth: lm,\r\n\t\t\tlunarDay: ld,\r\n\t\t}\r\n\t},\r\n\t/**\r\n\t * @description 计算农历年是否有闰月，参数为存储农历年的16进制\r\n\t * \t\t\t\t农历年份信息用16进制存储，其中16进制的最后1位可以用于判断是否有闰月\r\n\t * */\r\n\thasLeapMonth: function(ly) {\r\n\t\t// 获取16进制的最后1位，需要用到&与运算符\r\n\t\tif (ly & 0xf) {\r\n\t\t\treturn ly & 0xf\r\n\t\t} else {\r\n\t\t\treturn false\r\n\t\t}\r\n\t},\r\n\t/**\r\n\t * @description 如果有闰月，计算农历闰月天数，参数为存储农历年的16进制\r\n\t *\t\t\t\t农历年份信息用16进制存储，其中16进制的第1位（0x除外）可以用于表示闰月是大月还是小月\r\n\t * */\r\n\tleapMonthDays: function(ly) {\r\n\t\tif (this.hasLeapMonth(ly)) {\r\n\t\t\t// 获取16进制的第1位（0x除外）\r\n\t\t\treturn (ly & 0xf0000) ? 30 : 29\r\n\t\t} else {\r\n\t\t\treturn 0\r\n\t\t}\r\n\t},\r\n\t/**\r\n\t * @description 计算农历一年的总天数，参数为存储农历年的16进制\r\n\t *\t\t\t\t农历年份信息用16进制存储，其中16进制的第2-4位（0x除外）可以用于表示正常月是大月还是小月\r\n\t * */\r\n\tlunarYearDays: function(ly) {\r\n\t\tlet totalDays = 0;\r\n\r\n\t\t// 获取正常月的天数，并累加\r\n\t\t// 获取16进制的第2-4位，需要用到>>移位运算符\r\n\t\tfor (let i = 0x8000; i > 0x8; i >>= 1) {\r\n\t\t\tlet monthDays = (ly & i) ? 30 : 29;\r\n\t\t\ttotalDays += monthDays;\r\n\t\t}\r\n\t\t// 如果有闰月，需要把闰月的天数加上\r\n\t\tif (this.hasLeapMonth(ly)) {\r\n\t\t\ttotalDays += this.leapMonthDays(ly);\r\n\t\t}\r\n\r\n\t\treturn totalDays\r\n\t},\r\n\t/**\r\n\t * @description 获取农历每个月的天数  参数需传入16进制数值\r\n\t * */\r\n\tlunarYearMonths: function(ly) {\r\n\t\tlet monthArr = [];\r\n\t\tlet that = this;\r\n\t\t// 获取正常月的天数，并添加到monthArr数组中\r\n\t\t// 获取16进制的第2-4位，需要用到>>移位运算符\r\n\t\tfor (let i = 0x8000; i > 0x8; i >>= 1) {\r\n\t\t\tmonthArr.push((ly & i) ? 30 : 29);\r\n\t\t}\r\n\t\t// 如果有闰月，需要把闰月的天数加上\r\n\t\tif (this.hasLeapMonth(ly)) {\r\n\t\t\tmonthArr.splice(this.hasLeapMonth(ly), 0, that.leapMonthDays(ly));\r\n\t\t}\r\n\r\n\t\treturn monthArr\r\n\t},\r\n\t/**\r\n\t * @description 将农历年转换为天干，参数为农历年\r\n\t * */\r\n\tgetTianGan: function(ly) {\r\n\t\tlet tianGanKey = (ly - 3) % 10;\r\n\t\tif (tianGanKey === 0) tianGanKey = 10;\r\n\t\treturn this.tianGan[tianGanKey - 1]\r\n\t},\r\n\t/**\r\n\t * @description 将农历年转换为地支，参数为农历年\r\n\t * */\r\n\tgetDiZhi: function(ly) {\r\n\t\tlet diZhiKey = (ly - 3) % 12;\r\n\t\tif (diZhiKey === 0) diZhiKey = 12;\r\n\t\treturn this.diZhi[diZhiKey - 1]\r\n\t}\r\n}\n\r\nexport default lunarYearTool;"],"names":[],"mappings":"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"}