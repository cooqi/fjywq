{"version":3,"file":"fd-EmbedCalendar.js","sources":["components/fd-EmbedCalendar/fd-EmbedCalendar.vue","D:/ruanjian/HBuilderX.3.6.18.20230117/HBuilderX/plugins/uniapp-cli-vite/uniComponent:/RTovd2ViL2Nvb3FpL2ZqeXdxL2NvbXBvbmVudHMvZmQtRW1iZWRDYWxlbmRhci9mZC1FbWJlZENhbGVuZGFyLnZ1ZQ"],"sourcesContent":["<template>\r\n\t<view class=\"sign-calendar\">\r\n\t\t<!--顶部区域-->\r\n\t\t<view class=\"top-section\" v-if=\"showTopSection\">\r\n\t\t\t<view class=\"greeting-area\">\r\n\t\t\t\t<!-- \t<image class=\"avatar\" :src=\"avatarSrc || '/static/logo.png'\" mode=\"aspectFill\"\r\n\t\t\t\t\t\t@error=\"onImageError\"></image> -->\r\n\t\t\t\t<view class=\"speech-bubble\" :style=\"{'background':bgcolorGreeting}\">\r\n\t\t\t\t\t<text class=\"greeting-text\" >{{ greetingText }}</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<!-- <view class=\"avatar-section\">\r\n\t\t\t\t\t<text class=\"plan-title\">宇青日历</text>\r\n\t\t\t\t</view> -->\r\n\t\t\t\t<view class=\"plan-section\">\r\n\t\t\t\t\t<view class=\"plan-indicator\" @click=\"onTodayPlanClick\">今</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- 年月显示与导航箭头 -->\r\n\t\t<view class=\"header\">\r\n\t\t\t<view class=\"year-month-section\">\r\n\t\t\t\t<view class=\"year-month\">\r\n\t\t\t\t\t<view class=\"title\" @click=\"changeYM\">{{ y }}年 {{ m + 1 }}月</view>\r\n\t\t\t\t</view>\r\n\r\n\t\t\t\t<!-- 月/周视图切换按钮 -->\r\n\t\t\t\t<view class=\"view-toggle\">\r\n\t\t\t\t\t<view class=\"arrow-btn\" @click=\"turning('prev')\">\r\n\t\t\t\t\t\t<text class=\"arrow-icon\">‹</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"toggle-item\" :class=\"{ active: monthOpen }\" @click=\"switchToMonth\">\r\n\t\t\t\t\t\t月\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"toggle-item\" :class=\"{ active: !monthOpen }\" @click=\"switchToWeek\">\r\n\t\t\t\t\t\t周\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"arrow-btn\" @click=\"turning('next')\">\r\n\t\t\t\t\t\t<text class=\"arrow-icon\">›</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- 星期行显示 -->\r\n\t\t<view class=\"week-header\">\r\n\t\t\t<view v-for=\"(item, index) in weekDay\" :key=\"index\" class=\"week-item\">\r\n\t\t\t\t{{ item }}\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- 日历网格 -->\r\n\t\t<view class=\"calendar-grid\" :class=\"{ 'week-view': !monthOpen }\">\r\n\t\t\t<view class=\"grid-container\" :style=\"{ transform: `translateY(${positionTop}rpx)` }\">\r\n\t\t\t\t<view v-for=\"(item, index) in dates\" :key=\"index\" class=\"date-item\" :class=\"{ 'other-month': !item.lm }\"\r\n\t\t\t\t\t@click=\"selectOne(item, $event)\">\r\n\t\t\t\t\t<view class=\"date-circle\" :class=\"{\r\n              selected: choose == `${item.year}-${item.month + 1}-${item.date}`,\r\n              today: isToday(item.year, item.month, item.date) && item.lm,\r\n              'special-date':\r\n                isSigned(item.year, item.month + 1, item.date) && item.lm,\r\n              disabled: !item.lm,\r\n            }\">\r\n\t\t\t\t\t\t{{ item.date }}\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t\r\n\t\t<jpTimePicker ref='date-time' datestype=\"year-month\" :datestring='dateString' @confirm='dateTimeChange'></jpTimePicker>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\t import jpTimePicker from '@/components/jp-timePicker/jp-timePicker.vue'\r\n\texport default {\r\n\t\tname: \"EmbedCalendar\",\r\n\t\tcomponents: {\r\n\t\t\tjpTimePicker\r\n\t\t},\r\n\t\tprops: {\r\n\t\t\t// 第一列星期几\r\n\t\t\tweekstart: {\r\n\t\t\t\ttype: Number,\r\n\t\t\t\tdefault: 7,\r\n\t\t\t},\r\n\t\t\t// 已经签到的日期\r\n\t\t\tsignedDates: {\r\n\t\t\t\ttype: Array,\r\n\t\t\t\tdefault: () => [],\r\n\t\t\t},\r\n\t\t\t// 是否展开\r\n\t\t\topen: {\r\n\t\t\t\ttype: Boolean,\r\n\t\t\t\tdefault: true,\r\n\t\t\t},\r\n\t\t\t// 头像图片路径\r\n\t\t\tavatarSrc: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: \"\",\r\n\t\t\t},\r\n\t\t\t// 问候语文本\r\n\t\t\tgreetingText: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: \"我闻着饼香来到到街中央\",\r\n\t\t\t},\r\n\t\t\t// 是否显示顶部区域\r\n\t\t\tshowTopSection: {\r\n\t\t\t\ttype: Boolean,\r\n\t\t\t\tdefault: true,\r\n\t\t\t},\r\n\t\t\tbgcolorGreeting: {//欢迎词背景\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: \"#c3ffff\",\r\n\t\t\t},\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\ttext: {\r\n\t\t\t\t\tyear: \"年\",\r\n\t\t\t\t\tmonth: \"月\",\r\n\t\t\t\t\tweek: [\"一\", \"二\", \"三\", \"四\", \"五\", \"六\", \"日\"],\r\n\t\t\t\t\ttoday: \"今\",\r\n\t\t\t\t},\r\n\t\t\t\ty: new Date().getFullYear(), // 年\r\n\t\t\t\tm: new Date().getMonth(), // 月\r\n\t\t\t\tdates: [], // 当前月日期集合\r\n\t\t\t\tpositionTop: 0,\r\n\t\t\t\tmonthOpen: true,\r\n\t\t\t\tchoose: \"\",\r\n\t\t\t\tcurrentWeekIndex: 0, // 当前周的索引（用于周视图导航）\r\n\t\t\t\tselectedDate: null, // 当前选中的日期对象（用于周视图定位）\r\n\t\t\t\tdateString:''\r\n\t\t\t};\r\n\t\t},\r\n\t\tcreated() {\r\n\t\t\t// 获取当前日期\r\n\t\t\tlet date = new Date();\r\n\t\t\tthis.y = date.getFullYear();\r\n\t\t\tthis.m = date.getMonth();\r\n\r\n\t\t\tthis.dates = this.monthDay(this.y, this.m);\r\n\r\n\t\t\t// 根据 open 属性设置初始视图状态\r\n\t\t\tthis.monthOpen = this.open;\r\n\r\n\t\t\t// 如果初始状态是周视图，需要计算位置\r\n\t\t\tif (!this.open) {\r\n\t\t\t\tlet index = -1;\r\n\t\t\t\tthis.dates.forEach((i, x) => {\r\n\t\t\t\t\tthis.isToday(i.year, i.month, i.date) && (index = x);\r\n\t\t\t\t});\r\n\t\t\t\tthis.positionTop = -((Math.ceil((index + 1) / 7) || 1) - 1) * 80;\r\n\t\t\t}\r\n\t\t},\r\n\t\tmounted() {\r\n\t\t\tlet date = new Date();\r\n\t\t\tlet y = date.getFullYear();\r\n\t\t\tlet m = date.getMonth();\r\n\t\t\tlet d = date.getDate();\r\n\r\n\t\t\t// 不设置初始选中状态，只设置定位信息\r\n\t\t\tthis.choose = \"\";\r\n\r\n\t\t\t// 设置选中的日期对象（用于周视图定位）\r\n\t\t\tthis.selectedDate = {\r\n\t\t\t\tyear: y,\r\n\t\t\t\tmonth: m,\r\n\t\t\t\tdate: d,\r\n\t\t\t};\r\n\r\n\t\t\tconsole.log(\"初始化完成，无选中状态\");\r\n\r\n\t\t\t// 如果初始状态是周视图，更新位置\r\n\t\t\tif (!this.monthOpen) {\r\n\t\t\t\tthis.updateWeekPosition();\r\n\t\t\t}\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\t// 顶部星期栏目\r\n\t\t\tweekDay() {\r\n\t\t\t\treturn this.text.week\r\n\t\t\t\t\t.slice(this.weekstart - 1)\r\n\t\t\t\t\t.concat(this.text.week.slice(0, this.weekstart - 1));\r\n\t\t\t},\r\n\t\t\theight() {\r\n\t\t\t\treturn (this.dates.length / 7) * 80 + \"upx\";\r\n\t\t\t},\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\t// 获取当前月份天数\r\n\t\t\tmonthDay(y, m) {\r\n\t\t\t\tlet firstDayOfMonth = new Date(y, m, 1).getDay(); // 当月第一天星期几\r\n\t\t\t\tlet lastDateOfMonth = new Date(y, m + 1, 0).getDate(); // 当月最后一天\r\n\t\t\t\tlet lastDayOfLastMonth = new Date(y, m, 0).getDate(); // 上一月的最后一天\r\n\t\t\t\tlet dates = []; // 所有渲染日历\r\n\t\t\t\tlet weekstart = this.weekstart == 7 ? 0 : this.weekstart; // 方便进行日期计算，默认星期从0开始\r\n\t\t\t\tlet startDay = (() => {\r\n\t\t\t\t\t// 周初有几天是上个月的\r\n\t\t\t\t\tif (firstDayOfMonth == weekstart) {\r\n\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t} else if (firstDayOfMonth > weekstart) {\r\n\t\t\t\t\t\treturn firstDayOfMonth - weekstart;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn 7 - weekstart + firstDayOfMonth;\r\n\t\t\t\t\t}\r\n\t\t\t\t})();\r\n\t\t\t\tlet endDay = 7 - ((startDay + lastDateOfMonth) % 7); // 结束还有几天是下个月的\r\n\t\t\t\tfor (let i = 1; i <= startDay; i++) {\r\n\t\t\t\t\tdates.push({\r\n\t\t\t\t\t\tdate: lastDayOfLastMonth - startDay + i,\r\n\t\t\t\t\t\tday: weekstart + i - 1 || 7,\r\n\t\t\t\t\t\tmonth: m - 1 >= 0 ? m - 1 : 12,\r\n\t\t\t\t\t\tyear: m - 1 >= 0 ? y : y - 1,\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tfor (let j = 1; j <= lastDateOfMonth; j++) {\r\n\t\t\t\t\tdates.push({\r\n\t\t\t\t\t\tdate: j,\r\n\t\t\t\t\t\tday: (j % 7) + firstDayOfMonth - 1 || 7,\r\n\t\t\t\t\t\tmonth: m,\r\n\t\t\t\t\t\tyear: y,\r\n\t\t\t\t\t\tlm: true,\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tfor (let k = 1; k <= endDay; k++) {\r\n\t\t\t\t\tdates.push({\r\n\t\t\t\t\t\tdate: k,\r\n\t\t\t\t\t\tday: (lastDateOfMonth + startDay + weekstart + k - 1) % 7 || 7,\r\n\t\t\t\t\t\tmonth: m + 1 <= 11 ? m + 1 : 0,\r\n\t\t\t\t\t\tyear: m + 1 <= 11 ? y : y + 1,\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\treturn dates;\r\n\t\t\t},\r\n\t\t\t// 已经签到处理\r\n\t\t\tisSigned(y, m, d) {\r\n\t\t\t\tlet flag = false;\r\n\t\t\t\tif (!this.signedDates || !Array.isArray(this.signedDates)) {\r\n\t\t\t\t\tconsole.log('签到数组为空或不是数组:', this.signedDates);\r\n\t\t\t\t\treturn flag;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst dateStr = `${m}-${d}`;\r\n\t\t\t\tfor (let i = 0; i < this.signedDates.length; i++) {\r\n\t\t\t\t\tif (this.signedDates[i] == dateStr) {\r\n\t\t\t\t\t\tflag = true;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 调试信息 - 可以在控制台看到\r\n\t\t\t\t// console.log(`检查签到日期 ${dateStr}:`, flag, '签到数组:', this.signedDates);\r\n\r\n\t\t\t\treturn flag;\r\n\t\t\t},\r\n\t\t\tisToday(y, m, d) {\r\n\t\t\t\tlet date = new Date();\r\n\t\t\t\treturn (\r\n\t\t\t\t\ty == date.getFullYear() && m == date.getMonth() && d == date.getDate()\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t\t// 切换成周模式\r\n\t\t\ttrgWeek() {\r\n\t\t\t\tthis.monthOpen = !this.monthOpen;\r\n\t\t\t\tif (this.monthOpen) {\r\n\t\t\t\t\tthis.positionTop = 0;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlet index = -1;\r\n\t\t\t\t\tthis.dates.forEach((i, x) => {\r\n\t\t\t\t\t\tthis.isToday(i.year, i.month, i.date) && (index = x);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthis.positionTop = -((Math.ceil((index + 1) / 7) || 1) - 1) * 80;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t// 切换到月视图\r\n\t\t\tswitchToMonth() {\r\n\t\t\t\tif (!this.monthOpen) {\r\n\t\t\t\t\tthis.monthOpen = true;\r\n\t\t\t\t\tthis.positionTop = 0;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t// 切换到周视图\r\n\t\t\tswitchToWeek() {\r\n\t\t\t\tif (this.monthOpen) {\r\n\t\t\t\t\tthis.monthOpen = false;\r\n\t\t\t\t\t// 确保选中日期在当前月份，然后更新周位置\r\n\t\t\t\t\tthis.updateSelectedDateToCurrentMonth();\r\n\t\t\t\t\tthis.updateWeekPosition();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t// 更新周视图位置\r\n\t\t\tupdateWeekPosition() {\r\n\t\t\t\tlet index = -1;\r\n\r\n\t\t\t\t// 确保有合理的选中日期\r\n\t\t\t\tif (!this.selectedDate) {\r\n\t\t\t\t\t// 如果没有选中日期，使用今天\r\n\t\t\t\t\tlet today = new Date();\r\n\t\t\t\t\tthis.selectedDate = {\r\n\t\t\t\t\t\tyear: today.getFullYear(),\r\n\t\t\t\t\t\tmonth: today.getMonth(),\r\n\t\t\t\t\t\tdate: today.getDate(),\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 确保选中日期在当前月份范围内\r\n\t\t\t\tthis.updateSelectedDateToCurrentMonth();\r\n\r\n\t\t\t\t// 在当前月份数据中查找选中日期的索引\r\n\t\t\t\tthis.dates.forEach((item, x) => {\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\titem.year === this.selectedDate.year &&\r\n\t\t\t\t\t\titem.month === this.selectedDate.month &&\r\n\t\t\t\t\t\titem.date === this.selectedDate.date &&\r\n\t\t\t\t\t\titem.lm\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\t// 确保是当前月的日期\r\n\t\t\t\t\t\tindex = x;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// 如果没找到，尝试找今天的日期\r\n\t\t\t\tif (index === -1) {\r\n\t\t\t\t\tthis.dates.forEach((item, x) => {\r\n\t\t\t\t\t\tif (this.isToday(item.year, item.month, item.date) && item.lm) {\r\n\t\t\t\t\t\t\tindex = x;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 如果还是没找到，默认显示第一周\r\n\t\t\t\tif (index === -1) {\r\n\t\t\t\t\tindex = 0;\r\n\t\t\t\t\t// 找到第一个当前月的日期\r\n\t\t\t\t\tfor (let i = 0; i < this.dates.length; i++) {\r\n\t\t\t\t\t\tif (this.dates[i].lm) {\r\n\t\t\t\t\t\t\tindex = i;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.currentWeekIndex = Math.floor(index / 7);\r\n\t\t\t\tthis.positionTop = -(this.currentWeekIndex * 80);\r\n\t\t\t},\r\n\t\t\t// 点击回调\r\n\t\t\tselectOne(i, event) {\r\n\t\t\t\tlet date = `${i.year}-${i.month + 1}-${i.date}`;\r\n\t\t\t\tlet selectD = new Date(date);\r\n\r\n\t\t\t\t// 记录选中的日期对象\r\n\t\t\t\tthis.selectedDate = {\r\n\t\t\t\t\tyear: i.year,\r\n\t\t\t\t\tmonth: i.month,\r\n\t\t\t\t\tdate: i.date,\r\n\t\t\t\t};\r\n\r\n\t\t\t\t// 如果点击的是非当前月的日期，则跳转到对应月份\r\n\t\t\t\tif (selectD.getMonth() != this.m) {\r\n\t\t\t\t\tthis.y = i.year;\r\n\t\t\t\t\tthis.m = i.month;\r\n\t\t\t\t\tthis.dates = this.monthDay(this.y, this.m);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.choose = date;\r\n\r\n\t\t\t\t// 如果在周视图下，更新周位置\r\n\t\t\t\tif (!this.monthOpen) {\r\n\t\t\t\t\tthis.updateWeekPosition();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.$emit(\"on-click\", {\r\n\t\t\t\t\tdate: date,\r\n\t\t\t\t\tyear: i.year,\r\n\t\t\t\t\tmonth: i.month + 1,\r\n\t\t\t\t\tday: i.date,\r\n\t\t\t\t\tisToday: this.isToday(i.year, i.month, i.date),\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tchangeYM(){\r\n\t\t\t\t//\r\n\t\t\t\t this.$refs['date-time'].show();\r\n\t\t\t},\r\n\t\t\t dateTimeChange(value) {\r\n\t\t\t\tthis.$emit(\"year-month-change\",value);\r\n\t\t\t\t// 如果当前显示的不是所在的月份，则跳转到的月份\r\n\t\t\t\tlet time=value.split('-')\r\n\t\t\t\tthis.y=time[0]\r\n\t\t\t\tthis.m=parseInt(time[1]) - 1 \r\n\t\t\t\tthis.dates = this.monthDay(this.y, this.m);\r\n\t\t\t\t// 如果在周视图下，更新周位置\r\n\t\t\t\tif (!this.monthOpen) {\r\n\t\t\t\t\tthis.updateWeekPosition();\r\n\t\t\t\t}\r\n\t\t\t\tthis.positionTop = 0;\r\n\t\t\t\t\r\n\t\t\t\t// 重要：更新选中日期到新月份的对应日期，确保周视图能正确定位\r\n\t\t\t\tthis.updateSelectedDateToCurrentMonth();\r\n\t\t\t},\r\n\t\t\t// 上个月/周，下个月/周 - 智能导航\r\n\t\t\tturning(_action) {\r\n\t\t\t\tif (this.monthOpen) {\r\n\t\t\t\t\t// 月视图：按月导航\r\n\t\t\t\t\tthis.turningByMonth(_action);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// 周视图：按周导航\r\n\t\t\t\t\tthis.turningByWeek(_action);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t// 按月导航\r\n\t\t\tturningByMonth(_action) {\r\n\t\t\t\tif (_action === \"next\") {\r\n\t\t\t\t\tif (this.m + 1 == 12) {\r\n\t\t\t\t\t\tthis.m = 0;\r\n\t\t\t\t\t\tthis.y = this.y + 1;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.m = this.m + 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (this.m + 1 == 1) {\r\n\t\t\t\t\t\tthis.m = 11;\r\n\t\t\t\t\t\tthis.y = this.y - 1;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.m = this.m - 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.dates = this.monthDay(this.y, this.m);\r\n\t\t\t\tthis.positionTop = 0;\r\n\r\n\t\t\t\t// 重要：更新选中日期到新月份的对应日期，确保周视图能正确定位\r\n\t\t\t\tthis.updateSelectedDateToCurrentMonth();\r\n\r\n\t\t\t\t// 触发月份变化事件\r\n\t\t\t\tthis.$emit(\"month-change\", {\r\n\t\t\t\t\tyear: this.y,\r\n\t\t\t\t\tmonth: this.m + 1\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t// 按周导航\r\n\t\t\tturningByWeek(_action) {\r\n\t\t\t\t// 获取当前周的第一天\r\n\t\t\t\tlet currentWeekFirstDay = this.getCurrentWeekFirstDay();\r\n\r\n\t\t\t\tif (_action === \"next\") {\r\n\t\t\t\t\t// 下一周：加7天\r\n\t\t\t\t\tcurrentWeekFirstDay.setDate(currentWeekFirstDay.getDate() + 7);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// 上一周：减7天\r\n\t\t\t\t\tcurrentWeekFirstDay.setDate(currentWeekFirstDay.getDate() - 7);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 检查是否需要切换月份\r\n\t\t\t\tlet newYear = currentWeekFirstDay.getFullYear();\r\n\t\t\t\tlet newMonth = currentWeekFirstDay.getMonth();\r\n\r\n\t\t\t\tif (newYear !== this.y || newMonth !== this.m) {\r\n\t\t\t\t\t// 需要切换月份\r\n\t\t\t\t\tthis.y = newYear;\r\n\t\t\t\t\tthis.m = newMonth;\r\n\t\t\t\t\tthis.dates = this.monthDay(this.y, this.m);\r\n\r\n\t\t\t\t\t// 触发月份变化事件\r\n\t\t\t\t\tthis.$emit(\"month-change\", {\r\n\t\t\t\t\t\tyear: this.y,\r\n\t\t\t\t\t\tmonth: this.m + 1\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 更新选中的日期为新周的同一天（如果之前有选中日期）\r\n\t\t\t\tif (this.selectedDate) {\r\n\t\t\t\t\tlet selectedWeekDay = new Date(\r\n\t\t\t\t\t\tthis.selectedDate.year,\r\n\t\t\t\t\t\tthis.selectedDate.month,\r\n\t\t\t\t\t\tthis.selectedDate.date\r\n\t\t\t\t\t).getDay();\r\n\t\t\t\t\tlet newSelectedDate = new Date(currentWeekFirstDay);\r\n\t\t\t\t\tnewSelectedDate.setDate(\r\n\t\t\t\t\t\tcurrentWeekFirstDay.getDate() +\r\n\t\t\t\t\t\t(selectedWeekDay === 0 ? 6 : selectedWeekDay - 1)\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tthis.selectedDate = {\r\n\t\t\t\t\t\tyear: newSelectedDate.getFullYear(),\r\n\t\t\t\t\t\tmonth: newSelectedDate.getMonth(),\r\n\t\t\t\t\t\tdate: newSelectedDate.getDate(),\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\t// 清除选中状态，只保留定位信息\r\n\t\t\t\t\tthis.choose = \"\";\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 更新周视图位置\r\n\t\t\t\tthis.updateWeekPosition();\r\n\t\t\t},\r\n\t\t\t// 获取当前周的第一天（周一）\r\n\t\t\tgetCurrentWeekFirstDay() {\r\n\t\t\t\tlet referenceDate;\r\n\r\n\t\t\t\tif (this.selectedDate) {\r\n\t\t\t\t\treferenceDate = new Date(\r\n\t\t\t\t\t\tthis.selectedDate.year,\r\n\t\t\t\t\t\tthis.selectedDate.month,\r\n\t\t\t\t\t\tthis.selectedDate.date\r\n\t\t\t\t\t);\r\n\t\t\t\t} else {\r\n\t\t\t\t\treferenceDate = new Date(); // 使用今天\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet dayOfWeek = referenceDate.getDay();\r\n\t\t\t\tlet daysToMonday = dayOfWeek === 0 ? 6 : dayOfWeek - 1; // 周日为0，需要减去6天到周一\r\n\r\n\t\t\t\tlet monday = new Date(referenceDate);\r\n\t\t\t\tmonday.setDate(referenceDate.getDate() - daysToMonday);\r\n\r\n\t\t\t\treturn monday;\r\n\t\t\t},\r\n\t\t\t// 更新选中日期到当前月份（用于月份切换后保持合理的选中状态）\r\n\t\t\tupdateSelectedDateToCurrentMonth() {\r\n\t\t\t\tif (!this.selectedDate) {\r\n\t\t\t\t\t// 如果没有选中日期，默认选择当前月的第一天，但不设置为选中状态\r\n\t\t\t\t\tthis.selectedDate = {\r\n\t\t\t\t\t\tyear: this.y,\r\n\t\t\t\t\t\tmonth: this.m,\r\n\t\t\t\t\t\tdate: 1,\r\n\t\t\t\t\t};\r\n\t\t\t\t\t// 不设置choose，保持无选中状态\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 如果选中日期不在当前显示的月份中，需要调整\r\n\t\t\t\tif (\r\n\t\t\t\t\tthis.selectedDate.year !== this.y ||\r\n\t\t\t\t\tthis.selectedDate.month !== this.m\r\n\t\t\t\t) {\r\n\t\t\t\t\t// 获取当前月的最大天数\r\n\t\t\t\t\tlet maxDate = new Date(this.y, this.m + 1, 0).getDate();\r\n\t\t\t\t\t// 保持相同的日期，但如果超出当前月的天数，则使用最后一天\r\n\t\t\t\t\tlet newDate = Math.min(this.selectedDate.date, maxDate);\r\n\r\n\t\t\t\t\tthis.selectedDate = {\r\n\t\t\t\t\t\tyear: this.y,\r\n\t\t\t\t\t\tmonth: this.m,\r\n\t\t\t\t\t\tdate: newDate,\r\n\t\t\t\t\t};\r\n\t\t\t\t\t// 清除选中状态，只保留定位信息\r\n\t\t\t\t\tthis.choose = \"\";\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t// 获取日期下方的显示文本（21日显示为21）\r\n\t\t\tgetSubText(item) {\r\n\t\t\t\tif (this.isToday(item.year, item.month, item.date)) {\r\n\t\t\t\t\treturn \"今\";\r\n\t\t\t\t}\r\n\t\t\t\treturn \"\";\r\n\t\t\t},\r\n\t\t\t// 点击今日计划\r\n\t\t\tonTodayPlanClick() {\r\n\t\t\t\tthis.$emit(\"today-plan-click\");\r\n\t\t\t\t// 自动定位到今天的日期\r\n\t\t\t\tlet date = new Date();\r\n\t\t\t\tlet y = date.getFullYear();\r\n\t\t\t\tlet m = date.getMonth();\r\n\t\t\t\tlet d = date.getDate();\r\n\r\n\t\t\t\t// 如果当前显示的不是今天所在的月份，则跳转到今天的月份\r\n\t\t\t\tif (this.y !== y || this.m !== m) {\r\n\t\t\t\t\tthis.y = y;\r\n\t\t\t\t\tthis.m = m;\r\n\t\t\t\t\tthis.dates = this.monthDay(this.y, this.m);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\r\n\t\t\t\t// 选中今天的日期（这里可以选中，因为是用户主动点击）\r\n\t\t\t\tthis.choose = `${y}-${m + 1}-${d}`;\r\n\t\t\t\tthis.selectedDate = {\r\n\t\t\t\t\tyear: y,\r\n\t\t\t\t\tmonth: m,\r\n\t\t\t\t\tdate: d,\r\n\t\t\t\t};\r\n\r\n\t\t\t\t// 如果在周视图下，更新周位置\r\n\t\t\t\tif (!this.monthOpen) {\r\n\t\t\t\t\tthis.updateWeekPosition();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t// 图片加载错误处理\r\n\t\t\tonImageError(e) {\r\n\t\t\t\tconsole.log('头像加载失败:', e);\r\n\t\t\t\t// 可以在这里设置默认头像或其他处理\r\n\t\t\t},\r\n\t\t},\r\n\t};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\t.sign-calendar {\r\n\t\twidth: 100%;\r\n\t\tbackground-color: #f8f9fb;\r\n\t\tborder-radius: 24rpx;\r\n\t\tpadding: 40rpx 30rpx;\r\n\t\tbox-sizing: border-box;\r\n\t\tfont-family: -apple-system, BlinkMacSystemFont, \"PingFang SC\", sans-serif;\r\n\r\n\t\t.top-section {\r\n\t\t\tmargin-bottom: 30rpx;\r\n\r\n\t\t\t.greeting-area {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tjustify-content: space-between;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tpadding: 0;\r\n\r\n\t\t\t\t.avatar-section {\r\n\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\talign-items: center;\r\n\t\t\t\t\tflex: 1;\r\n\r\n\t\t\t\t\t.avatar {\r\n\t\t\t\t\t\twidth: 110rpx;\r\n\t\t\t\t\t\theight: 110rpx;\r\n\t\t\t\t\t\tborder-radius: 50%;\r\n\t\t\t\t\t\tbackground-color: white;\r\n\t\t\t\t\t\tborder: 3rpx solid #e5e5e5;\r\n\t\t\t\t\t\tpadding: 8rpx;\r\n\t\t\t\t\t\tflex-shrink: 0;\r\n\t\t\t\t\t\tz-index: 20;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\t.speech-bubble {\r\n\t\t\t\t\t\tposition: relative;\r\n\t\t\t\t\t\tbackground-color: white;\r\n\t\t\t\t\t\tborder-radius: 0 50rpx 50rpx 0;\r\n\t\t\t\t\t\tpadding: 14rpx 32rpx;\r\n\t\t\t\t\t\tpadding-left: 40rpx;\r\n\t\t\t\t\t\tmax-width: 80%;\r\n\t\t\t\t\t\tborder: #e5e5e5 3rpx solid;\r\n\t\t\t\t\t\tleft:-30rpx;\r\n\t\t\t\t\t\tz-index: 2;\r\n\t\t\t\t\t\tbackground: #c3ffff;\r\n\r\n\t\t\t\t\t\t.greeting-text {\r\n\t\t\t\t\t\t\tfont-size: 26rpx;\r\n\t\t\t\t\t\t\tcolor: #374151;\r\n\t\t\t\t\t\t\tdisplay: block;\r\n\t\t\t\t\t\t\tfont-weight: 500;\r\n\t\t\t\t\t\t\tline-height: 1.4;\r\n\t\t\t\t\t\t\twidth: 100%;\r\n\t\t\t\t\t\t\twhite-space: nowrap;\r\n\t\t\t\t\t\t\toverflow: hidden;\r\n\t\t\t\t\t\t\ttext-overflow: ellipsis;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t.plan-section {\r\n\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\talign-items: center;\r\n\t\t\t\t\tgap: 16rpx;\r\n\t\t\t\t\tflex-shrink: 0;\r\n\r\n\t\t\t\t\t.plan-indicator {\r\n\t\t\t\t\t\twidth: 88rpx;\r\n\t\t\t\t\t\theight: 88rpx;\r\n\t\t\t\t\t\tbackground: #f4e8fd;\r\n\t\t\t\t\t\tborder-radius: 50%;\r\n\t\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\t\talign-items: center;\r\n\t\t\t\t\t\tjustify-content: center;\r\n\t\t\t\t\t\tfont-size: 30rpx;\r\n\t\t\t\t\t\tfont-weight: 700;\r\n\t\t\t\t\t\tposition: relative;\r\n\t\t\t\t\t\ttransition: all 0.4s ease;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.arrow-btn {\r\n\t\t\twidth: 60rpx;\r\n\t\t\theight: 60rpx;\r\n\t\t\tdisplay: flex;\r\n\t\t\talign-items: center;\r\n\t\t\tjustify-content: center;\r\n\t\t\tbackground-color: rgba(255, 255, 255, 0.8);\r\n\t\t\tborder-radius: 50%;\r\n\t\t\tcursor: pointer;\r\n\t\t\ttransition: all 0.2s ease;\r\n\t\t\tbox-shadow: 0 2rpx 8rpx rgba(0, 0, 0, 0.1);\r\n\r\n\t\t\t&:active {\r\n\t\t\t\ttransform: scale(0.95);\r\n\t\t\t\tbackground-color: rgba(255, 255, 255, 1);\r\n\t\t\t}\r\n\r\n\t\t\t.arrow-icon {\r\n\t\t\t\tfont-size: 36rpx;\r\n\t\t\t\tcolor: #666;\r\n\t\t\t\tfont-weight: 500;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.plan-title {\r\n\t\t\tfont-size: 34rpx;\r\n\t\t\tfont-weight: 600;\r\n\t\t\tcolor: #1f2937;\r\n\t\t\tletter-spacing: 1rpx;\r\n\t\t}\r\n\r\n\t\t.header {\r\n\t\t\t.year-month-section {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\t//gap: 40rpx;\r\n\t\t\t\tmargin-bottom: 20rpx;\r\n\t\t\t\tjustify-content: space-between;\r\n\t\t\t\twidth: 100%;\r\n\r\n\t\t\t\t.year-month {\r\n\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\talign-items: center;\r\n\t\t\t\t\tjustify-content: center;\r\n\r\n\t\t\t\t\t.title {\r\n\t\t\t\t\t\tfont-size: 32rpx;\r\n\t\t\t\t\t\tfont-weight: 600;\r\n\t\t\t\t\t\tcolor: #1a1a1a;\r\n\t\t\t\t\t\tletter-spacing: 1rpx;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t.view-toggle {\r\n\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\tjustify-content: center;\r\n\t\t\t\t\tgap: 20rpx;\r\n\t\t\t\t\talign-items: center;\r\n\r\n\t\t\t\t\t.toggle-item {\r\n\t\t\t\t\t\twidth: 74rpx;\r\n\t\t\t\t\t\theight: 74rpx;\r\n\t\t\t\t\t\tline-height: 80rpx;\r\n\t\t\t\t\t\ttext-align: center;\r\n\t\t\t\t\t\tborder-radius: 50%;\r\n\t\t\t\t\t\tfont-size: 32rpx;\r\n\t\t\t\t\t\tfont-weight: 500;\r\n\t\t\t\t\t\tcolor: #666;\r\n\t\t\t\t\t\ttransition: all 0.3s ease;\r\n\t\t\t\t\t\tcursor: pointer;\r\n\t\t\t\t\t\tbackground-color: #eff1f5;\r\n\r\n\t\t\t\t\t\t&.active {\r\n\t\t\t\t\t\t\tbackground-color: #8b5cf6;\r\n\t\t\t\t\t\t\tcolor: white;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.week-header {\r\n\t\t\tdisplay: flex;\r\n\t\t\tjustify-content: space-around;\r\n\t\t\tpadding: 20rpx 0 10rpx;\r\n\r\n\t\t\t.week-item {\r\n\t\t\t\twidth: calc(100% / 7);\r\n\t\t\t\ttext-align: center;\r\n\t\t\t\tfont-size: 32rpx;\r\n\t\t\t\tfont-weight: 700;\r\n\t\t\t\tcolor: #333;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.calendar-grid {\r\n\t\t\tposition: relative;\r\n\t\t\theight: 480rpx;\r\n\t\t\t/* 6行 x 80rpx */\r\n\t\t\toverflow: hidden;\r\n\t\t\ttransition: height 0.3s ease;\r\n\r\n\t\t\t&.week-view {\r\n\t\t\t\theight: 80rpx;\r\n\t\t\t}\r\n\r\n\t\t\t.grid-container {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-wrap: wrap;\r\n\t\t\t\ttransition: transform 0.3s ease;\r\n\t\t\t\tjustify-content: space-between;\r\n\r\n\t\t\t\t.date-item {\r\n\t\t\t\t\twidth: calc(100% / 7);\r\n\t\t\t\t\theight: 80rpx;\r\n\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\tjustify-content: center;\r\n\t\t\t\t\talign-items: center;\r\n\t\t\t\t\tposition: relative;\r\n\t\t\t\t\tpadding: 4rpx;\r\n\r\n\t\t\t\t\t&.other-month {\r\n\t\t\t\t\t\t.date-circle {\r\n\t\t\t\t\t\t\tcolor: #d1d5db;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t.date-circle {\r\n\t\t\t\t\t\tposition: relative;\r\n\t\t\t\t\t\twidth: 52rpx;\r\n\t\t\t\t\t\theight: 52rpx;\r\n\t\t\t\t\t\tborder-radius: 50%;\r\n\t\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\t\tjustify-content: center;\r\n\t\t\t\t\t\talign-items: center;\r\n\t\t\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\t\t\tcolor: #3a4050;\r\n\t\t\t\t\t\t//font-weight: 500;\r\n\t\t\t\t\t\ttransition: all 0.2s ease;\r\n\t\t\t\t\t\tcursor: pointer;\r\n\t\t\t\t\t\tbackground-color: rgba(216, 216, 216, 0.4);\r\n\r\n\t\t\t\t\t\t&:hover {\r\n\t\t\t\t\t\t\tbackground-color: rgba(139, 92, 246, 0.1);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t&.selected {\r\n\t\t\t\t\t\t\tbackground-color: #8b5cf6;\r\n\t\t\t\t\t\t\tcolor: white;\r\n\t\t\t\t\t\t\tfont-weight: 600;\r\n\t\t\t\t\t\t\tborder: 3px solid rgba(139, 92, 246, 0.8);\r\n\t\t\t\t\t\t\tbox-shadow: 0 6rpx 20rpx rgba(139, 92, 246, 0.4);\r\n\t\t\t\t\t\t\ttransform: scale(1.05);\r\n\t\t\t\t\t\t\t&.today{\r\n\t\t\t\t\t\t\t\tborder-width:1px\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t&.today {\r\n\t\t\t\t\t\t\tbackground-color: #8b5cf6;\r\n\t\t\t\t\t\t\tcolor: white;\r\n\t\t\t\t\t\t\tfont-weight: 600;\r\n\t\t\t\t\t\t\tposition: relative;\r\n\r\n\t\t\t\t\t\t\t&::after {\r\n\t\t\t\t\t\t\t\tcontent: \"今\"; //可以写字代替\r\n\t\t\t\t\t\t\t\tposition: absolute;\r\n\t\t\t\t\t\t\t\tbottom: -2rpx;\r\n\t\t\t\t\t\t\t\tleft: 50%;\r\n\t\t\t\t\t\t\t\ttransform: translateX(-50%);\r\n\t\t\t\t\t\t\t\tfont-size: 30rpx;\r\n\t\t\t\t\t\t\t\tline-height: 1;\r\n\t\t\t\t\t\t\t\tcolor: white;\r\n\t\t\t\t\t\t\t\t//写字注释一下\r\n\t\t\t\t\t\t\t\tbackground: #8b5cf6;\r\n\t\t\t\t\t\t\t\tborder-radius: 100%;\r\n\t\t\t\t\t\t\t\twidth: 30px;\r\n\t\t\t\t\t\t\t\theight: 30px;\r\n\t\t\t\t\t\t\t\tbackground-size: 100%;\r\n\t\t\t\t\t\t\t\tbackground-repeat: no-repeat;\r\n\t\t\t\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\t\t\t\tjustify-content: center;\r\n\t\t\t\t\t\t\t\talign-items: center;\r\n\t\t\t\t\t\t\t\tz-index: 5;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t/* 如果今天也是签到日期，需要显示绿色背景 */\r\n\t\t\t\t\t\t\t&.special-date {\r\n\t\t\t\t\t\t\t\tbackground-color: #10b981;\r\n\t\t\t\t\t\t\t\t/* 改为绿色 */\r\n\r\n\t\t\t\t\t\t\t\t&::before {\r\n\t\t\t\t\t\t\t\t\tcontent: \"\";\r\n\t\t\t\t\t\t\t\t\tposition: absolute;\r\n\t\t\t\t\t\t\t\t\ttop: -4rpx;\r\n\t\t\t\t\t\t\t\t\tright: -4rpx;\r\n\t\t\t\t\t\t\t\t\twidth: 16rpx;\r\n\t\t\t\t\t\t\t\t\theight: 16rpx;\r\n\t\t\t\t\t\t\t\t\tbackground-color: #ef4444;\r\n\t\t\t\t\t\t\t\t\tborder-radius: 50%;\r\n\t\t\t\t\t\t\t\t\tborder: 2rpx solid white;\r\n\t\t\t\t\t\t\t\t\tz-index: 10;\r\n\t\t\t\t\t\t\t\t\t/* 确保红点在最上层 */\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t&.special-date {\r\n\t\t\t\t\t\t\tbackground-color: #10b981;\r\n\t\t\t\t\t\t\t/* 绿色背景 */\r\n\t\t\t\t\t\t\tcolor: white;\r\n\t\t\t\t\t\t\tfont-weight: 600;\r\n\r\n\t\t\t\t\t\t\t&::before {\r\n\t\t\t\t\t\t\t\tcontent: \"\";\r\n\t\t\t\t\t\t\t\tposition: absolute;\r\n\t\t\t\t\t\t\t\ttop: -4rpx;\r\n\t\t\t\t\t\t\t\tright: -4rpx;\r\n\t\t\t\t\t\t\t\twidth: 16rpx;\r\n\t\t\t\t\t\t\t\theight: 16rpx;\r\n\t\t\t\t\t\t\t\tbackground-color: #ef4444;\r\n\t\t\t\t\t\t\t\tborder-radius: 50%;\r\n\t\t\t\t\t\t\t\tborder: 2rpx solid white;\r\n\t\t\t\t\t\t\t\tz-index: 10;\r\n\t\t\t\t\t\t\t\t/* 确保红点在最上层 */\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t&.disabled {\r\n\t\t\t\t\t\t\tcolor: rgba(41, 41, 41, 0.5);\r\n\t\t\t\t\t\t\tpointer-events: none;\r\n\t\t\t\t\t\t\t//display: none;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</style>","import Component from 'E:/web/cooqi/fjywq/components/fd-EmbedCalendar/fd-EmbedCalendar.vue'\nwx.createComponent(Component)"],"names":["uni"],"mappings":"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"}