{"version":3,"file":"uni-data-pickerview.js","sources":["uni_modules/uni-data-picker/components/uni-data-pickerview/uni-data-pickerview.vue","D:/ruanjian/HBuilderX.3.6.18.20230117/HBuilderX/plugins/uniapp-cli-vite/uniComponent:/RTovd2ViL2Nvb3FpL2ZqeXdxL3VuaV9tb2R1bGVzL3VuaS1kYXRhLXBpY2tlci9jb21wb25lbnRzL3VuaS1kYXRhLXBpY2tlcnZpZXcvdW5pLWRhdGEtcGlja2Vydmlldy52dWU"],"sourcesContent":["<template>\r\n\t<view class=\"uni-data-pickerview\">\r\n\t\t<scroll-view class=\"selected-area\" scroll-x=\"true\" scroll-y=\"false\" :show-scrollbar=\"false\">\r\n\t\t\t<view class=\"selected-list\">\r\n\t\t\t\t<template v-for=\"(item,index) in selected\">\r\n\t\t\t\t\t<view class=\"selected-item\"\r\n\t\t\t\t\t\t:class=\"{'selected-item-active':index==selectedIndex, 'selected-item-text-overflow': ellipsis}\"\r\n\t\t\t\t\t\t v-if=\"item.text\" @click=\"handleSelect(index)\">\r\n\t\t\t\t\t\t<text class=\"\">{{item.text}}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</template>\r\n\t\t\t</view>\r\n\t\t</scroll-view>\r\n\t\t<view class=\"tab-c\">\r\n\t\t\t<template v-for=\"(child, i) in dataList\" >\r\n\t\t\t\t<scroll-view class=\"list\" :key=\"i\" v-if=\"i==selectedIndex\" :scroll-y=\"true\">\r\n\t\t\t\t\t<view class=\"item\" :class=\"{'is-disabled': !!item.disable}\" v-for=\"(item, j) in child\"\r\n\t\t\t\t\t\t@click=\"handleNodeClick(item, i, j)\">\r\n\t\t\t\t\t\t<text class=\"item-text item-text-overflow\">{{item[map.text]}}</text>\r\n\t\t\t\t\t\t<view class=\"check\" v-if=\"selected.length > i && item[map.value] == selected[i].value\"></view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</scroll-view>\r\n\t\t\t</template>\r\n\r\n\t\t\t<view class=\"loading-cover\" v-if=\"loading\">\r\n\t\t\t\t<uni-load-more class=\"load-more\" :contentText=\"loadMore\" status=\"loading\"></uni-load-more>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"error-message\" v-if=\"errorMessage\">\r\n\t\t\t\t<text class=\"error-text\">{{errorMessage}}</text>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport dataPicker from \"./uni-data-picker.js\"\r\n\r\n\t/**\r\n\t * DataPickerview\r\n\t * @description uni-data-pickerview\r\n\t * @tutorial https://ext.dcloud.net.cn/plugin?id=3796\r\n\t * @property {Array} localdata 本地数据，参考\r\n\t * @property {Boolean} step-searh = [true|false] 是否分布查询\r\n\t * @value true 启用分布查询，仅查询当前选中节点\r\n\t * @value false 关闭分布查询，一次查询出所有数据\r\n\t * @property {String|DBFieldString} self-field 分布查询当前字段名称\r\n\t * @property {String|DBFieldString} parent-field 分布查询父字段名称\r\n\t * @property {String|DBCollectionString} collection 表名\r\n\t * @property {String|DBFieldString} field 查询字段，多个字段用 `,` 分割\r\n\t * @property {String} orderby 排序字段及正序倒叙设置\r\n\t * @property {String|JQLString} where 查询条件\r\n\t */\r\n\texport default {\r\n\t\tname: 'UniDataPickerView',\r\n\t\temits: ['nodeclick', 'change', 'datachange', 'update:modelValue'],\r\n\t\tmixins: [dataPicker],\r\n\t\tprops: {\r\n\t\t\tmanagedMode: {\r\n\t\t\t\ttype: Boolean,\r\n\t\t\t\tdefault: false\r\n\t\t\t},\r\n\t\t\tellipsis: {\r\n\t\t\t\ttype: Boolean,\r\n\t\t\t\tdefault: true\r\n\t\t\t}\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {}\r\n\t\t},\r\n\t\tcreated() {\r\n\t\t\tif (this.managedMode) {\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\r\n\t\t\tthis.$nextTick(() => {\r\n\t\t\t\tthis.load()\r\n\t\t\t})\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tonPropsChange() {\r\n\t\t\t\tthis._treeData = []\r\n\t\t\t\tthis.selectedIndex = 0\r\n\t\t\t\tthis.load()\r\n\t\t\t},\r\n\t\t\tload() {\r\n\t\t\t\tif (this.isLocaldata) {\r\n\t\t\t\t\tthis.loadData()\r\n\t\t\t\t} else if (this.dataValue.length) {\r\n\t\t\t\t\tthis.getTreePath((res) => {\r\n\t\t\t\t\t\tthis.loadData()\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\thandleSelect(index) {\r\n\t\t\t\tthis.selectedIndex = index\r\n\t\t\t},\r\n\t\t\thandleNodeClick(item, i, j) {\r\n\t\t\t\tif (item.disable) {\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tconst node = this.dataList[i][j]\r\n\t\t\t\tconst text = node[this.map.text]\r\n\t\t\t\tconst value = node[this.map.value]\r\n\t\t\t\tif (i < this.selected.length - 1) {\r\n\t\t\t\t\tthis.selected.splice(i, this.selected.length - i)\r\n\t\t\t\t\tthis.selected.push({\r\n\t\t\t\t\t\ttext,\r\n\t\t\t\t\t\tvalue\r\n\t\t\t\t\t})\r\n\t\t\t\t} else if (i === this.selected.length - 1) {\r\n\t\t\t\t\tthis.selected.splice(i, 1, {\r\n\t\t\t\t\t\ttext,\r\n\t\t\t\t\t\tvalue\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (node.isleaf) {\r\n\t\t\t\t\tthis.onSelectedChange(node, node.isleaf)\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst {\r\n\t\t\t\t\tisleaf,\r\n\t\t\t\t\thasNodes\r\n\t\t\t\t} = this._updateBindData()\r\n\r\n\t\t\t\tif (!this._isTreeView() && !hasNodes) {\r\n\t\t\t\t\tthis.onSelectedChange(node, true)\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (this.isLocaldata && (!hasNodes || isleaf)) {\r\n\t\t\t\t\tthis.onSelectedChange(node, true)\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (!isleaf && !hasNodes) {\r\n\t\t\t\t\tthis._loadNodeData((data) => {\r\n\t\t\t\t\t\tif (!data.length) {\r\n\t\t\t\t\t\t\tnode.isleaf = true\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis._treeData.push(...data)\r\n\t\t\t\t\t\t\tthis._updateBindData(node)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.onSelectedChange(node, node.isleaf)\r\n\t\t\t\t\t}, this._nodeWhere())\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.onSelectedChange(node, false)\r\n\t\t\t},\r\n\t\t\tupdateData(data) {\r\n\t\t\t\tthis._treeData = data.treeData\r\n\t\t\t\tthis.selected = data.selected\r\n\t\t\t\tif (!this._treeData.length) {\r\n\t\t\t\t\tthis.loadData()\r\n\t\t\t\t} else {\r\n\t\t\t\t\t//this.selected = data.selected\r\n\t\t\t\t\tthis._updateBindData()\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tonDataChange() {\r\n\t\t\t\tthis.$emit('datachange')\r\n\t\t\t},\r\n\t\t\tonSelectedChange(node, isleaf) {\r\n\t\t\t\tif (isleaf) {\r\n\t\t\t\t\tthis._dispatchEvent()\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (node) {\r\n\t\t\t\t\tthis.$emit('nodeclick', node)\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t_dispatchEvent() {\r\n\t\t\t\tthis.$emit('change', this.selected.slice(0))\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n<style lang=\"scss\">\r\n\t$uni-primary: #007aff !default;\r\n\r\n\t.uni-data-pickerview {\r\n\t\tflex: 1;\r\n\t\t/* #ifndef APP-NVUE */\r\n\t\tdisplay: flex;\r\n\t\t/* #endif */\r\n\t\tflex-direction: column;\r\n\t\toverflow: hidden;\r\n\t\theight: 100%;\r\n\t}\r\n\r\n\t.error-text {\r\n\t\tcolor: #DD524D;\r\n\t}\r\n\r\n\t.loading-cover {\r\n\t\tposition: absolute;\r\n\t\tleft: 0;\r\n\t\ttop: 0;\r\n\t\tright: 0;\r\n\t\tbottom: 0;\r\n\t\tbackground-color: rgba(255, 255, 255, .5);\r\n\t\t/* #ifndef APP-NVUE */\r\n\t\tdisplay: flex;\r\n\t\t/* #endif */\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t\tz-index: 1001;\r\n\t}\r\n\r\n\t.load-more {\r\n\t\t/* #ifndef APP-NVUE */\r\n\t\tmargin: auto;\r\n\t\t/* #endif */\r\n\t}\r\n\r\n\t.error-message {\r\n\t\tbackground-color: #fff;\r\n\t\tposition: absolute;\r\n\t\tleft: 0;\r\n\t\ttop: 0;\r\n\t\tright: 0;\r\n\t\tbottom: 0;\r\n\t\tpadding: 15px;\r\n\t\topacity: .9;\r\n\t\tz-index: 102;\r\n\t}\r\n\r\n\t/* #ifdef APP-NVUE */\r\n\t.selected-area {\r\n\t\twidth: 750rpx;\r\n\t}\r\n\r\n\t/* #endif */\r\n\r\n\t.selected-list {\r\n\t\t/* #ifndef APP-NVUE */\r\n\t\tdisplay: flex;\r\n\t\t/* #endif */\r\n\t\tflex-direction: row;\r\n\t\tflex-wrap: nowrap;\r\n\t\tpadding: 0 5px;\r\n\t\tborder-bottom: 1px solid #f8f8f8;\r\n\t}\r\n\r\n\t.selected-item {\r\n\t\tmargin-left: 10px;\r\n\t\tmargin-right: 10px;\r\n\t\tpadding: 12px 0;\r\n\t\ttext-align: center;\r\n\t\t/* #ifndef APP-NVUE */\r\n\t\twhite-space: nowrap;\r\n\t\t/* #endif */\r\n\t}\r\n\r\n\t.selected-item-text-overflow {\r\n\t\twidth: 168px;\r\n\t\t/* fix nvue */\r\n\t\toverflow: hidden;\r\n\t\t/* #ifndef APP-NVUE */\r\n\t\twidth: 6em;\r\n\t\twhite-space: nowrap;\r\n\t\ttext-overflow: ellipsis;\r\n\t\t-o-text-overflow: ellipsis;\r\n\t\t/* #endif */\r\n\t}\r\n\r\n\t.selected-item-active {\r\n\t\tborder-bottom: 2px solid $uni-primary;\r\n\t}\r\n\r\n\t.selected-item-text {\r\n\t\tcolor: $uni-primary;\r\n\t}\r\n\r\n\t.tab-c {\r\n\t\tposition: relative;\r\n\t\tflex: 1;\r\n\t\t/* #ifndef APP-NVUE */\r\n\t\tdisplay: flex;\r\n\t\t/* #endif */\r\n\t\tflex-direction: row;\r\n\t\toverflow: hidden;\r\n\t}\r\n\r\n\t.list {\r\n\t\tflex: 1;\r\n\t}\r\n\r\n\t.item {\r\n\t\tpadding: 12px 15px;\r\n\t\t/* border-bottom: 1px solid #f0f0f0; */\r\n\t\t/* #ifndef APP-NVUE */\r\n\t\tdisplay: flex;\r\n\t\t/* #endif */\r\n\t\tflex-direction: row;\r\n\t\tjustify-content: space-between;\r\n\t}\r\n\r\n\t.is-disabled {\r\n\t\topacity: .5;\r\n\t}\r\n\r\n\t.item-text {\r\n\t\t/* flex: 1; */\r\n\t\tcolor: #333333;\r\n\t}\r\n\r\n\t.item-text-overflow {\r\n\t\twidth: 280px;\r\n\t\t/* fix nvue */\r\n\t\toverflow: hidden;\r\n\t\t/* #ifndef APP-NVUE */\r\n\t\twidth: 20em;\r\n\t\twhite-space: nowrap;\r\n\t\ttext-overflow: ellipsis;\r\n\t\t-o-text-overflow: ellipsis;\r\n\t\t/* #endif */\r\n\t}\r\n\r\n\t.check {\r\n\t\tmargin-right: 5px;\r\n\t\tborder: 2px solid $uni-primary;\r\n\t\tborder-left: 0;\r\n\t\tborder-top: 0;\r\n\t\theight: 12px;\r\n\t\twidth: 6px;\r\n\t\ttransform-origin: center;\r\n\t\t/* #ifndef APP-NVUE */\r\n\t\ttransition: all 0.3s;\r\n\t\t/* #endif */\r\n\t\ttransform: rotate(45deg);\r\n\t}\r\n</style>\r\n","import Component from 'E:/web/cooqi/fjywq/uni_modules/uni-data-picker/components/uni-data-pickerview/uni-data-pickerview.vue'\nwx.createComponent(Component)"],"names":["dataPicker"],"mappings":"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"}