{"version":3,"file":"add.js","sources":["uni_modules/uni-upgrade-center/pages/version/add.vue","D:/ruanjian/HBuilderX.3.6.18.20230117/HBuilderX/plugins/uniapp-cli-vite/uniPage:/dW5pX21vZHVsZXMvdW5pLXVwZ3JhZGUtY2VudGVyL3BhZ2VzL3ZlcnNpb24vYWRkLnZ1ZQ"],"sourcesContent":["<template>\r\n\t<view class=\"uni-container\">\r\n\t\t<view class=\"uni-header\">\r\n\t\t\t<view class=\"uni-group\">\r\n\t\t\t\t<view class=\"uni-title\">包类型</view>\r\n\t\t\t\t<view class=\"uni-sub-title\">{{type_valuetotext[formData.type]}}</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<uni-forms ref=\"form\" :value=\"formData\" validateTrigger=\"bind\" :labelWidth=\"labelWidth\">\r\n\t\t\t<uni-forms-item name=\"appid\" label=\"AppID\" required>\r\n\t\t\t\t<uni-easyinput :disabled=\"true\" v-model=\"formData.appid\" trim=\"both\" />\r\n\t\t\t</uni-forms-item>\r\n\t\t\t<uni-forms-item name=\"name\" label=\"应用名称\">\r\n\t\t\t\t<uni-easyinput :disabled=\"true\" v-model=\"formData.name\" trim=\"both\" />\r\n\t\t\t</uni-forms-item>\r\n\t\t\t<uni-forms-item name=\"title\" label=\"更新标题\">\r\n\t\t\t\t<uni-easyinput placeholder=\"更新标题\" v-model=\"formData.title\" />\r\n\t\t\t</uni-forms-item>\r\n\t\t\t<uni-forms-item name=\"contents\" label=\"更新内容\" required>\r\n\t\t\t\t<textarea auto-height style=\"box-sizing: content-box;\"\r\n\t\t\t\t\t@input=\"binddata('contents', $event.detail.value)\" class=\"uni-textarea-border\"\r\n\t\t\t\t\t:value=\"formData.contents\" @update:value=\"val => formData.contents = val\"></textarea>\r\n\t\t\t</uni-forms-item>\r\n\t\t\t<uni-forms-item name=\"platform\" label=\"平台\" required>\r\n\t\t\t\t<uni-data-checkbox :multiple=\"isWGT\" v-model=\"formData.platform\" :localdata=\"platformLocaldata\" />\r\n\t\t\t</uni-forms-item>\r\n\t\t\t<uni-forms-item name=\"version\" label=\"版本号\" required>\r\n\t\t\t\t<uni-easyinput v-model=\"formData.version\" placeholder=\"当前包版本号，必须大于当前线上发行版本号\" />\r\n\t\t\t</uni-forms-item>\r\n\t\t\t<uni-forms-item v-if=\"isWGT\" name=\"min_uni_version\" label=\"原生App最低版本\" :required=\"isWGT\">\r\n\t\t\t\t<uni-easyinput placeholder=\"原生App最低版本\" v-model=\"formData.min_uni_version\" />\r\n\t\t\t\t<show-info :content=\"minUniVersionContent\"></show-info>\r\n\t\t\t</uni-forms-item>\r\n\t\t\t<uni-forms-item v-if=\"!isiOS\" label=\"上传apk包\">\r\n\t\t\t\t<uni-file-picker v-model=\"appFileList\" :file-extname=\"fileExtname\" :disabled=\"hasPackage\"\r\n\t\t\t\t\treturnType=\"object\" file-mediatype=\"all\" limit=\"1\" @success=\"packageUploadSuccess\"\r\n\t\t\t\t\t@delete=\"packageDelete\">\r\n\t\t\t\t\t<view class=\"flex\">\r\n\t\t\t\t\t\t<button type=\"primary\" size=\"mini\" @click=\"selectFile\" style=\"margin: 0;\">选择文件</button>\r\n\t\t\t\t\t\t<text\r\n\t\t\t\t\t\t\tstyle=\"padding: 10px;font-size: 12px;color: #666;\">上传apk到当前服务空间的云存储中，上传成功后，会自动使用云存储地址填充下载链接</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</uni-file-picker>\r\n\t\t\t\t<text v-if=\"hasPackage\"\r\n\t\t\t\t\tstyle=\"padding-left: 20px;color: #a8a8a8;\">{{Number(appFileList.size / 1024 / 1024).toFixed(2)}}M</text>\r\n\t\t\t</uni-forms-item>\r\n\t\t\t<uni-forms-item name=\"url\" :label=\"isiOS ? 'AppStore' : '包地址'\" required>\r\n\t\t\t\t<uni-easyinput placeholder=\"可下载安装包地址\" v-model=\"formData.url\" :maxlength=\"-1\" />\r\n\t\t\t\t<show-info :top=\"-80\" :content=\"uploadFileContent\"></show-info>\r\n\t\t\t</uni-forms-item>\r\n\r\n\t\t\t<!-- <uni-forms-item v-if=\"formData.store_list\" name=\"store_list\" style=\"height: 0px;\"></uni-forms-item> -->\r\n\r\n\t\t\t<uni-forms-item v-if=\"isWGT\" name=\"is_silently\" label=\"静默更新\">\r\n\t\t\t\t<switch @change=\"binddata('is_silently', $event.detail.value)\" :checked=\"formData.is_silently\" />\r\n\t\t\t\t<show-info :top=\"-80\" :content=\"silentlyContent\"></show-info>\r\n\t\t\t</uni-forms-item>\r\n\t\t\t<uni-forms-item v-if=\"!isiOS\" name=\"is_mandatory\" label=\"强制更新\">\r\n\t\t\t\t<switch @change=\"binddata('is_mandatory', $event.detail.value)\" :checked=\"formData.is_mandatory\" />\r\n\t\t\t\t<show-info :content=\"mandatoryContent\"></show-info>\r\n\t\t\t</uni-forms-item>\r\n\t\t\t<uni-forms-item name=\"stable_publish\" label=\"上线发行\">\r\n\t\t\t\t<switch @change=\"binddata('stable_publish', $event.detail.value)\" :checked=\"formData.stable_publish\" />\r\n\t\t\t\t<show-info :top=\"-40\" :content=\"stablePublishContent2\"></show-info>\r\n\t\t\t</uni-forms-item>\r\n\t\t\t<uni-forms-item v-show=\"false\" name=\"type\" label=\"安装包类型\">\r\n\t\t\t\t<uni-data-checkbox v-model=\"formData.type\" :localdata=\"formOptions.type_localdata\" />\r\n\t\t\t</uni-forms-item>\r\n\t\t\t<view class=\"uni-button-group\">\r\n\t\t\t\t<button type=\"primary\" class=\"uni-button\" style=\"width: 100px;\" @click=\"submit\">发布</button>\r\n\t\t\t\t<button type=\"warn\" class=\"uni-button\" style=\"width: 100px;margin-left: 15px;\" @click=\"back\">取消</button>\r\n\t\t\t</view>\r\n\t\t</uni-forms>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport {\r\n\t\tvalidator,\r\n\t\tenumConverter\r\n\t} from '@/uni_modules/uni-upgrade-center/js_sdk/validator/opendb-app-versions.js';\r\n\timport addAndDetail, {\r\n\t\tfields\r\n\t} from '../mixin/version_add_detail_mixin.js';\r\n\timport {\r\n\t\tappVersionListDbName\r\n\t} from '../utils.js';\r\n\timport showInfo from '../components/show-info.vue'\r\n\r\n\tconst db = uniCloud.database();\r\n\tconst dbCmd = db.command;\r\n\tconst dbCollectionName = appVersionListDbName;\r\n\r\n\tconst platform_iOS = 'iOS';\r\n\tconst platform_Android = 'Android';\r\n\r\n\t/**\r\n\t * 对比版本号，如需要，请自行修改判断规则\r\n\t * 支持比对\t(\"3.0.0.0.0.1.0.1\", \"3.0.0.0.0.1\")\t(\"3.0.0.1\", \"3.0\")\t(\"3.1.1\", \"3.1.1.1\") 之类的\r\n\t * @param {Object} v1\r\n\t * @param {Object} v2\r\n\t * v1 > v2 return 1\r\n\t * v1 < v2 return -1\r\n\t * v1 == v2 return 0\r\n\t */\r\n\tfunction compare(v1 = '0', v2 = '0') {\r\n\t\tv1 = String(v1).split('.')\r\n\t\tv2 = String(v2).split('.')\r\n\t\tconst minVersionLens = Math.min(v1.length, v2.length);\r\n\r\n\t\tlet result = 0;\r\n\t\tfor (let i = 0; i < minVersionLens; i++) {\r\n\t\t\tconst curV1 = Number(v1[i])\r\n\t\t\tconst curV2 = Number(v2[i])\r\n\r\n\t\t\tif (curV1 > curV2) {\r\n\t\t\t\tresult = 1\r\n\t\t\t\tbreak;\r\n\t\t\t} else if (curV1 < curV2) {\r\n\t\t\t\tresult = -1\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (result === 0 && (v1.length !== v2.length)) {\r\n\t\t\tconst v1BiggerThenv2 = v1.length > v2.length;\r\n\t\t\tconst maxLensVersion = v1BiggerThenv2 ? v1 : v2;\r\n\t\t\tfor (let i = minVersionLens; i < maxLensVersion.length; i++) {\r\n\t\t\t\tconst curVersion = Number(maxLensVersion[i])\r\n\t\t\t\tif (curVersion > 0) {\r\n\t\t\t\t\tv1BiggerThenv2 ? result = 1 : result = -1\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\texport default {\r\n\t\tcomponents: {\r\n\t\t\tshowInfo\r\n\t\t},\r\n\t\tmixins: [addAndDetail],\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tlatestVersion: '0.0.0',\r\n\t\t\t\tlastVersionId: ''\r\n\t\t\t}\r\n\t\t},\r\n\t\tasync onLoad({\r\n\t\t\tappid,\r\n\t\t\tname,\r\n\t\t\ttype\r\n\t\t}) {\r\n\t\t\tif (appid && type && name) {\r\n\t\t\t\t// const store_list = await this.getStoreList(appid)\r\n\t\t\t\tthis.formData = {\r\n\t\t\t\t\t...this.formData,\r\n\t\t\t\t\t...{\r\n\t\t\t\t\t\tappid,\r\n\t\t\t\t\t\tname,\r\n\t\t\t\t\t\ttype,\r\n\t\t\t\t\t\t// store_list\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.latestStableData = await this.getDetail(appid, type)\r\n\t\t\t\t// 如果有数据，否则为发布第一版，默认为Android\r\n\t\t\t\tif (!this.isWGT && this.latestStableData.length) {\r\n\t\t\t\t\tthis.setFormData(platform_Android)\r\n\t\t\t\t}\r\n\t\t\t\t// 如果是wgt ，则需要将 min_uni_version 设为必填\r\n\t\t\t\tif (this.isWGT) {\r\n\t\t\t\t\tthis.rules.min_uni_version.rules.push({\r\n\t\t\t\t\t\t\"required\": true\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\twatch: {\r\n\t\t\tisiOS(val) {\r\n\t\t\t\tif (val) {\r\n\t\t\t\t\tthis.setFormData(platform_iOS)\r\n\t\t\t\t\treturn;\r\n\t\t\t\t} else if (this.hasPackage) {\r\n\t\t\t\t\tthis.formData.url = this.appFileList.url\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tthis.formData.url = ''\r\n\t\t\t},\r\n\t\t\t\"formData.platform\"(val) {\r\n\t\t\t\t// wgt热更新数据渲染\r\n\t\t\t\tif (this.isWGT) {\r\n\t\t\t\t\tthis.setFormData(val)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tsetFormData(os) {\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\tmask: true\r\n\t\t\t\t})\r\n\t\t\t\t// 每次需初始化 版本 与 id ，因为可能是新增第一版\r\n\t\t\t\tthis.latestVersion = '0.0.0';\r\n\t\t\t\tthis.lastVersionId = ''\r\n\r\n\t\t\t\tconst data = this.getData(this.latestStableData, os)[0]\r\n\r\n\t\t\t\tif (data) {\r\n\t\t\t\t\tconst {\r\n\t\t\t\t\t\t_id,\r\n\t\t\t\t\t\tversion,\r\n\t\t\t\t\t\tname,\r\n\t\t\t\t\t\tplatform,\r\n\t\t\t\t\t\tmin_uni_version,\r\n\t\t\t\t\t\turl\r\n\t\t\t\t\t} = data\r\n\r\n\t\t\t\t\tthis.lastVersionId = _id\r\n\t\t\t\t\tthis.latestVersion = version;\r\n\r\n\t\t\t\t\tthis.formData.name = name\r\n\r\n\t\t\t\t\t// 如果不是wgt，则需要删除 min_uni_version 字段\r\n\t\t\t\t\tif (!this.isWGT) {\r\n\t\t\t\t\t\tdelete this.formData.min_uni_version;\r\n\t\t\t\t\t\tthis.formData.platform = platform[0]\r\n\r\n\t\t\t\t\t\t// iOS需要带出上一版本的AppStore链接\r\n\t\t\t\t\t\tif (this.isiOS) {\r\n\t\t\t\t\t\t\tthis.formData.url = url;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.formData.min_uni_version = min_uni_version\r\n\t\t\t\t\t\t// this.formData.platform = [os]\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (this.isWGT) {\r\n\t\t\t\t\tthis.formData.min_uni_version = ''\r\n\t\t\t\t}\r\n\t\t\t\tuni.hideLoading()\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 触发表单提交\r\n\t\t\t */\r\n\t\t\tsubmit() {\r\n\t\t\t\tif (!this.formData.url && this.isiOS) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ticon: 'error',\r\n\t\t\t\t\t\ttitle: 'AppStore 链接必填'\r\n\t\t\t\t\t})\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\tmask: true\r\n\t\t\t\t})\r\n\t\t\t\tthis.$refs.form.validate().then((res) => {\r\n\t\t\t\t\t// TODO 兼容 uni-forms 的bug\r\n\t\t\t\t\tres.url = this.formData.url\r\n\t\t\t\t\tif (compare(this.latestVersion, res.version) >= 0) {\r\n\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\tcontent: `版本号必须大于当前已上线版本（${this.latestVersion}）`,\r\n\t\t\t\t\t\t\tshowCancel: false\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\tthrow new Error('版本号必须大于已上线版本（${this.latestVersion}）');\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// 如果不是 wgt 更新，则需将 platform 字段还原为 array\r\n\t\t\t\t\tif (!this.isWGT) {\r\n\t\t\t\t\t\tres.platform = [res.platform]\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (this.isiOS || this.isWGT) delete res.store_list;\r\n\t\t\t\t\tif (res.store_list) {\r\n\t\t\t\t\t\tres.store_list.forEach(item => {\r\n\t\t\t\t\t\t\titem.priority = parseFloat(item.priority)\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.submitForm(res)\r\n\t\t\t\t}).catch((errors) => {\r\n\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tasync submitForm(value) {\r\n\t\t\t\tvalue = this.createCenterRecord(value)\r\n\t\t\t\tconst collectionDB = db.collection(dbCollectionName)\r\n\t\t\t\t// uni-stat 会创建这些字段 appid\r\n\t\t\t\tlet recordCreateByUniStat = []\r\n\t\t\t\tif (!this.isWGT) {\r\n\t\t\t\t\trecordCreateByUniStat = await this.getDetail(value.appid, value.type, this.createStatQuery(value))\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet dbOperate\r\n\t\t\t\tif (!recordCreateByUniStat.length) {\r\n\t\t\t\t\tdbOperate = collectionDB.add(value)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvalue.create_date = Date.now()\r\n\t\t\t\t\tdbOperate = collectionDB.doc(recordCreateByUniStat[0]._id).update(value)\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 使用 clientDB 提交数据\r\n\t\t\t\tdbOperate.then(async (res) => {\r\n\t\t\t\t\t// 如果新增版本为上线发行，且之前有该平台的上线发行，则自动将上一版设为下线\r\n\t\t\t\t\tif (value.stable_publish && this.lastVersionId) {\r\n\t\t\t\t\t\tawait collectionDB.doc(this.lastVersionId).update({\r\n\t\t\t\t\t\t\tstable_publish: false\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '新增成功'\r\n\t\t\t\t\t})\r\n\t\t\t\t\tthis.getOpenerEventChannel().emit('refreshData')\r\n\t\t\t\t\tsetTimeout(() => uni.navigateBack(), 500)\r\n\t\t\t\t}).catch((err) => {\r\n\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\tcontent: err.message || '请求服务失败',\r\n\t\t\t\t\t\tshowCancel: false\r\n\t\t\t\t\t})\r\n\t\t\t\t}).finally(() => {\r\n\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 获取表单数据\r\n\t\t\t * @param {Object} id\r\n\t\t\t */\r\n\t\t\tgetDetail(appid, type, args = {}) {\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\tmask: true\r\n\t\t\t\t})\r\n\t\t\t\treturn db.collection(dbCollectionName)\r\n\t\t\t\t\t.where(\r\n\t\t\t\t\t\tObject.assign({\r\n\t\t\t\t\t\t\tappid,\r\n\t\t\t\t\t\t\ttype,\r\n\t\t\t\t\t\t\tstable_publish: true\r\n\t\t\t\t\t\t}, args)\r\n\t\t\t\t\t)\r\n\t\t\t\t\t.field(fields)\r\n\t\t\t\t\t.get()\r\n\t\t\t\t\t.then((res) => res.result.data)\r\n\t\t\t\t\t.catch((err) => {\r\n\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\tcontent: err.message || '请求服务失败',\r\n\t\t\t\t\t\t\tshowCancel: false\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}).finally(() => {\r\n\t\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tgetStoreList(appid) {\r\n\t\t\t\treturn db.collection('opendb-app-list')\r\n\t\t\t\t\t.where({\r\n\t\t\t\t\t\tappid\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.get()\r\n\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\tconst data = res.result.data[0]\r\n\t\t\t\t\t\treturn data.store_list || []\r\n\t\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tgetData(data = [], platform) {\r\n\t\t\t\tif (typeof platform === 'string') {\r\n\t\t\t\t\treturn data.filter(item => item.platform.includes(platform))\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn data.filter(item => item.platform.toString() === platform.toString())\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tback() {\r\n\t\t\t\tuni.showModal({\r\n\t\t\t\t\ttitle: '取消发布',\r\n\t\t\t\t\tcontent: this.hasPackage ? '将会删除已上传的包' : undefined,\r\n\t\t\t\t\tsuccess: res => {\r\n\t\t\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\t\t\t// 若已上传包但取消发布，则自动将包删除\r\n\t\t\t\t\t\t\tif (this.hasPackage) {\r\n\t\t\t\t\t\t\t\tlet fileList = [];\r\n\t\t\t\t\t\t\t\tfileList.push(this.appFileList.url)\r\n\t\t\t\t\t\t\t\tthis.$request('deleteFile', {\r\n\t\t\t\t\t\t\t\t\tfileList\r\n\t\t\t\t\t\t\t\t}, {\r\n\t\t\t\t\t\t\t\t\tfunctionName: 'upgrade-center'\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tuni.navigateBack()\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n\t::v-deep .uni-forms-item__content {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t.uni-button-group {\r\n\t\t& button {\r\n\t\t\tmargin-left: 15px;\r\n\t\t}\r\n\r\n\t\t& button:first-child {\r\n\t\t\tmargin-left: 0px;\r\n\t\t}\r\n\t}\r\n\r\n\t.title_padding {\r\n\t\tpadding-bottom: 15px;\r\n\t\tdisplay: block;\r\n\t}\r\n\r\n\t::v-deep .uni-file-picker__files {\r\n\t\tmax-width: 100%;\r\n\t}\r\n</style>\r\n","import MiniProgramPage from 'E:/web/cooqi/fjywq/uni_modules/uni-upgrade-center/pages/version/add.vue'\nwx.createPage(MiniProgramPage)"],"names":["uniCloud","appVersionListDbName","addAndDetail","uni","fields"],"mappings":";;;;AAuFC,iBAAiB,MAAW;AAE5B,MAAM,KAAKA,iBAAS;AACN,GAAG;AACjB,MAAM,mBAAmBC,yCAAAA;AAEzB,MAAM,eAAe;AACrB,MAAM,mBAAmB;AAWzB,SAAS,QAAQ,KAAK,KAAK,KAAK,KAAK;AACpC,OAAK,OAAO,EAAE,EAAE,MAAM,GAAG;AACzB,OAAK,OAAO,EAAE,EAAE,MAAM,GAAG;AACzB,QAAM,iBAAiB,KAAK,IAAI,GAAG,QAAQ,GAAG,MAAM;AAEpD,MAAI,SAAS;AACb,WAAS,IAAI,GAAG,IAAI,gBAAgB,KAAK;AACxC,UAAM,QAAQ,OAAO,GAAG,CAAC,CAAC;AAC1B,UAAM,QAAQ,OAAO,GAAG,CAAC,CAAC;AAE1B,QAAI,QAAQ,OAAO;AAClB,eAAS;AACT;AAAA,IACD,WAAW,QAAQ,OAAO;AACzB,eAAS;AACT;AAAA,IACD;AAAA,EACD;AAEA,MAAI,WAAW,KAAM,GAAG,WAAW,GAAG,QAAS;AAC9C,UAAM,iBAAiB,GAAG,SAAS,GAAG;AACtC,UAAM,iBAAiB,iBAAiB,KAAK;AAC7C,aAAS,IAAI,gBAAgB,IAAI,eAAe,QAAQ,KAAK;AAC5D,YAAM,aAAa,OAAO,eAAe,CAAC,CAAC;AAC3C,UAAI,aAAa,GAAG;AACnB,yBAAiB,SAAS,IAAI,SAAS;AACvC;AAAA,MACD;AAAA,IACD;AAAA,EACD;AAEA,SAAO;AACR;AAEA,MAAK,YAAU;AAAA,EACd,YAAY;AAAA,IACX;AAAA,EACA;AAAA,EACD,QAAQ,CAACC,kEAAAA,YAAY;AAAA,EACrB,OAAO;AACN,WAAO;AAAA,MACN,eAAe;AAAA,MACf,eAAe;AAAA,IAChB;AAAA,EACA;AAAA,EACD,MAAM,OAAO;AAAA,IACZ;AAAA,IACA;AAAA,IACA;AAAA,EACD,GAAG;AACF,QAAI,SAAS,QAAQ,MAAM;AAE1B,WAAK,WAAW;AAAA,QACf,GAAG,KAAK;AAAA,QACR,GAAG;AAAA,UACF;AAAA,UACA;AAAA,UACA;AAAA;AAAA,QAED;AAAA,MACD;AAEA,WAAK,mBAAmB,MAAM,KAAK,UAAU,OAAO,IAAI;AAExD,UAAI,CAAC,KAAK,SAAS,KAAK,iBAAiB,QAAQ;AAChD,aAAK,YAAY,gBAAgB;AAAA,MAClC;AAEA,UAAI,KAAK,OAAO;AACf,aAAK,MAAM,gBAAgB,MAAM,KAAK;AAAA,UACrC,YAAY;AAAA,SACZ;AAAA,MACF;AAAA,IACD;AAAA,EACA;AAAA,EACD,OAAO;AAAA,IACN,MAAM,KAAK;AACV,UAAI,KAAK;AACR,aAAK,YAAY,YAAY;AAC7B;AAAA,iBACU,KAAK,YAAY;AAC3B,aAAK,SAAS,MAAM,KAAK,YAAY;AACrC;AAAA,MACD;AACA,WAAK,SAAS,MAAM;AAAA,IACpB;AAAA,IACD,oBAAoB,KAAK;AAExB,UAAI,KAAK,OAAO;AACf,aAAK,YAAY,GAAG;AAAA,MACrB;AAAA,IACD;AAAA,EACA;AAAA,EACD,SAAS;AAAA,IACR,YAAY,IAAI;AACfC,oBAAAA,MAAI,YAAY;AAAA,QACf,MAAM;AAAA,OACN;AAED,WAAK,gBAAgB;AACrB,WAAK,gBAAgB;AAErB,YAAM,OAAO,KAAK,QAAQ,KAAK,kBAAkB,EAAE,EAAE,CAAC;AAEtD,UAAI,MAAM;AACT,cAAM;AAAA,UACL;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,YACG;AAEJ,aAAK,gBAAgB;AACrB,aAAK,gBAAgB;AAErB,aAAK,SAAS,OAAO;AAGrB,YAAI,CAAC,KAAK,OAAO;AAChB,iBAAO,KAAK,SAAS;AACrB,eAAK,SAAS,WAAW,SAAS,CAAC;AAGnC,cAAI,KAAK,OAAO;AACf,iBAAK,SAAS,MAAM;AAAA,UACrB;AAAA,eACM;AACN,eAAK,SAAS,kBAAkB;AAAA,QAEjC;AAAA,MACD,WAAW,KAAK,OAAO;AACtB,aAAK,SAAS,kBAAkB;AAAA,MACjC;AACAA,oBAAAA,MAAI,YAAY;AAAA,IAChB;AAAA;AAAA;AAAA;AAAA,IAID,SAAS;AACR,UAAI,CAAC,KAAK,SAAS,OAAO,KAAK,OAAO;AACrCA,sBAAAA,MAAI,UAAU;AAAA,UACb,MAAM;AAAA,UACN,OAAO;AAAA,SACP;AACD;AAAA,MACD;AACAA,oBAAAA,MAAI,YAAY;AAAA,QACf,MAAM;AAAA,OACN;AACD,WAAK,MAAM,KAAK,SAAQ,EAAG,KAAK,CAAC,QAAQ;AAExC,YAAI,MAAM,KAAK,SAAS;AACxB,YAAI,QAAQ,KAAK,eAAe,IAAI,OAAO,KAAK,GAAG;AAClDA,wBAAAA,MAAI,UAAU;AAAA,YACb,SAAS,kBAAkB,KAAK,aAAa;AAAA,YAC7C,YAAY;AAAA,WACZ;AACD,gBAAM,IAAI,MAAM,qCAAqC;AAAA,QAEtD;AAEA,YAAI,CAAC,KAAK,OAAO;AAChB,cAAI,WAAW,CAAC,IAAI,QAAQ;AAAA,QAC7B;AACA,YAAI,KAAK,SAAS,KAAK;AAAO,iBAAO,IAAI;AACzC,YAAI,IAAI,YAAY;AACnB,cAAI,WAAW,QAAQ,UAAQ;AAC9B,iBAAK,WAAW,WAAW,KAAK,QAAQ;AAAA,WACxC;AAAA,QACF;AACA,aAAK,WAAW,GAAG;AAAA,MACpB,CAAC,EAAE,MAAM,CAAC,WAAW;AACpBA,sBAAAA,MAAI,YAAY;AAAA,OAChB;AAAA,IACD;AAAA,IACD,MAAM,WAAW,OAAO;AACvB,cAAQ,KAAK,mBAAmB,KAAK;AACrC,YAAM,eAAe,GAAG,WAAW,gBAAgB;AAEnD,UAAI,wBAAwB,CAAC;AAC7B,UAAI,CAAC,KAAK,OAAO;AAChB,gCAAwB,MAAM,KAAK,UAAU,MAAM,OAAO,MAAM,MAAM,KAAK,gBAAgB,KAAK,CAAC;AAAA,MAClG;AAEA,UAAI;AACJ,UAAI,CAAC,sBAAsB,QAAQ;AAClC,oBAAY,aAAa,IAAI,KAAK;AAAA,aAC5B;AACN,cAAM,cAAc,KAAK,IAAI;AAC7B,oBAAY,aAAa,IAAI,sBAAsB,CAAC,EAAE,GAAG,EAAE,OAAO,KAAK;AAAA,MACxE;AAGA,gBAAU,KAAK,OAAO,QAAQ;AAE7B,YAAI,MAAM,kBAAkB,KAAK,eAAe;AAC/C,gBAAM,aAAa,IAAI,KAAK,aAAa,EAAE,OAAO;AAAA,YACjD,gBAAgB;AAAA,WAChB;AAAA,QACF;AACAA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,SACP;AACD,aAAK,sBAAqB,EAAG,KAAK,aAAa;AAC/C,mBAAW,MAAMA,cAAAA,MAAI,aAAY,GAAI,GAAG;AAAA,MACzC,CAAC,EAAE,MAAM,CAAC,QAAQ;AACjBA,sBAAAA,MAAI,UAAU;AAAA,UACb,SAAS,IAAI,WAAW;AAAA,UACxB,YAAY;AAAA,SACZ;AAAA,MACF,CAAC,EAAE,QAAQ,MAAM;AAChBA,sBAAAA,MAAI,YAAY;AAAA,OAChB;AAAA,IACD;AAAA;AAAA;AAAA;AAAA;AAAA,IAKD,UAAU,OAAO,MAAM,OAAO,CAAA,GAAI;AACjCA,oBAAAA,MAAI,YAAY;AAAA,QACf,MAAM;AAAA,OACN;AACD,aAAO,GAAG,WAAW,gBAAgB,EACnC;AAAA,QACA,OAAO,OAAO;AAAA,UACb;AAAA,UACA;AAAA,UACA,gBAAgB;AAAA,QAChB,GAAE,IAAI;AAAA,MACR,EACC,MAAMC,kEAAAA,MAAM,EACZ,IAAI,EACJ,KAAK,CAAC,QAAQ,IAAI,OAAO,IAAI,EAC7B,MAAM,CAAC,QAAQ;AACfD,sBAAAA,MAAI,UAAU;AAAA,UACb,SAAS,IAAI,WAAW;AAAA,UACxB,YAAY;AAAA,SACZ;AAAA,MACF,CAAC,EAAE,QAAQ,MAAM;AAChBA,sBAAAA,MAAI,YAAY;AAAA,OAChB;AAAA,IACF;AAAA,IACD,aAAa,OAAO;AACnB,aAAO,GAAG,WAAW,iBAAiB,EACpC,MAAM;AAAA,QACN;AAAA,OACA,EACA,IAAI,EACJ,KAAK,SAAO;AACZ,cAAM,OAAO,IAAI,OAAO,KAAK,CAAC;AAC9B,eAAO,KAAK,cAAc,CAAC;AAAA,OAC3B;AAAA,IACF;AAAA,IACD,QAAQ,OAAO,CAAE,GAAE,UAAU;AAC5B,UAAI,OAAO,aAAa,UAAU;AACjC,eAAO,KAAK,OAAO,UAAQ,KAAK,SAAS,SAAS,QAAQ,CAAC;AAAA,aACrD;AACN,eAAO,KAAK,OAAO,UAAQ,KAAK,SAAS,SAAS,MAAM,SAAS,UAAU;AAAA,MAC5E;AAAA,IACA;AAAA,IACD,OAAO;AACNA,oBAAAA,MAAI,UAAU;AAAA,QACb,OAAO;AAAA,QACP,SAAS,KAAK,aAAa,cAAc;AAAA,QACzC,SAAS,SAAO;AACf,cAAI,IAAI,SAAS;AAEhB,gBAAI,KAAK,YAAY;AACpB,kBAAI,WAAW,CAAA;AACf,uBAAS,KAAK,KAAK,YAAY,GAAG;AAClC,mBAAK,SAAS,cAAc;AAAA,gBAC3B;AAAA,cACD,GAAG;AAAA,gBACF,cAAc;AAAA,eACd;AAAA,YACF;AAEAA,0BAAAA,MAAI,aAAa;AAAA,UAClB;AAAA,QACD;AAAA,MACD,CAAC;AAAA,IACF;AAAA,EACD;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACrYD,GAAG,WAAW,eAAe;"}